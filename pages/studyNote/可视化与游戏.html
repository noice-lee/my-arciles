<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>可视化与游戏 - 黑马在职加薪 | 不加冰</title>
    <meta name="generator" content="VuePress 1.9.7">
    
    <meta name="description" content="">
    
    <link rel="preload" href="/my-articles/assets/css/0.styles.82ef5590.css" as="style"><link rel="preload" href="/my-articles/assets/js/app.6e1f7d07.js" as="script"><link rel="preload" href="/my-articles/assets/js/2.2fae7045.js" as="script"><link rel="preload" href="/my-articles/assets/js/51.8de6d8ea.js" as="script"><link rel="prefetch" href="/my-articles/assets/js/10.236f6cfd.js"><link rel="prefetch" href="/my-articles/assets/js/11.59235104.js"><link rel="prefetch" href="/my-articles/assets/js/12.b616c485.js"><link rel="prefetch" href="/my-articles/assets/js/13.5c74cf35.js"><link rel="prefetch" href="/my-articles/assets/js/14.03805914.js"><link rel="prefetch" href="/my-articles/assets/js/15.42d1ae84.js"><link rel="prefetch" href="/my-articles/assets/js/16.6e6f2447.js"><link rel="prefetch" href="/my-articles/assets/js/17.6a6d78a6.js"><link rel="prefetch" href="/my-articles/assets/js/18.538fce41.js"><link rel="prefetch" href="/my-articles/assets/js/19.9d03793b.js"><link rel="prefetch" href="/my-articles/assets/js/20.ae9496e4.js"><link rel="prefetch" href="/my-articles/assets/js/21.30f4c6d2.js"><link rel="prefetch" href="/my-articles/assets/js/22.30091873.js"><link rel="prefetch" href="/my-articles/assets/js/23.c539f758.js"><link rel="prefetch" href="/my-articles/assets/js/24.492efe21.js"><link rel="prefetch" href="/my-articles/assets/js/25.b9c7de0f.js"><link rel="prefetch" href="/my-articles/assets/js/26.df21d45c.js"><link rel="prefetch" href="/my-articles/assets/js/27.1936162b.js"><link rel="prefetch" href="/my-articles/assets/js/28.8cd526e2.js"><link rel="prefetch" href="/my-articles/assets/js/29.b53b4870.js"><link rel="prefetch" href="/my-articles/assets/js/3.fe0cf31b.js"><link rel="prefetch" href="/my-articles/assets/js/30.63115fc7.js"><link rel="prefetch" href="/my-articles/assets/js/31.b340b56f.js"><link rel="prefetch" href="/my-articles/assets/js/32.3306fe2c.js"><link rel="prefetch" href="/my-articles/assets/js/33.6ea06d11.js"><link rel="prefetch" href="/my-articles/assets/js/34.6bfcabef.js"><link rel="prefetch" href="/my-articles/assets/js/35.ba1c41a9.js"><link rel="prefetch" href="/my-articles/assets/js/36.cdaebf72.js"><link rel="prefetch" href="/my-articles/assets/js/37.b895809c.js"><link rel="prefetch" href="/my-articles/assets/js/38.dbe90dfa.js"><link rel="prefetch" href="/my-articles/assets/js/39.0ac3a99b.js"><link rel="prefetch" href="/my-articles/assets/js/4.86334ad0.js"><link rel="prefetch" href="/my-articles/assets/js/40.12870f87.js"><link rel="prefetch" href="/my-articles/assets/js/41.83407e32.js"><link rel="prefetch" href="/my-articles/assets/js/42.5b886e48.js"><link rel="prefetch" href="/my-articles/assets/js/43.938bd23c.js"><link rel="prefetch" href="/my-articles/assets/js/44.120dac5d.js"><link rel="prefetch" href="/my-articles/assets/js/45.c7ee485b.js"><link rel="prefetch" href="/my-articles/assets/js/46.0eabca3a.js"><link rel="prefetch" href="/my-articles/assets/js/47.3b2e91cf.js"><link rel="prefetch" href="/my-articles/assets/js/48.a04f3876.js"><link rel="prefetch" href="/my-articles/assets/js/49.df7276ae.js"><link rel="prefetch" href="/my-articles/assets/js/5.4b909c37.js"><link rel="prefetch" href="/my-articles/assets/js/50.781d10d1.js"><link rel="prefetch" href="/my-articles/assets/js/52.e705d229.js"><link rel="prefetch" href="/my-articles/assets/js/53.c2dcf1c7.js"><link rel="prefetch" href="/my-articles/assets/js/54.d755bc64.js"><link rel="prefetch" href="/my-articles/assets/js/55.1af3e06f.js"><link rel="prefetch" href="/my-articles/assets/js/56.46b4f65f.js"><link rel="prefetch" href="/my-articles/assets/js/57.d874eb71.js"><link rel="prefetch" href="/my-articles/assets/js/58.fd82e51c.js"><link rel="prefetch" href="/my-articles/assets/js/59.3874e8a9.js"><link rel="prefetch" href="/my-articles/assets/js/6.7c4e0979.js"><link rel="prefetch" href="/my-articles/assets/js/7.cf85dab5.js"><link rel="prefetch" href="/my-articles/assets/js/8.9a142d2e.js"><link rel="prefetch" href="/my-articles/assets/js/9.4708d526.js">
    <link rel="stylesheet" href="/my-articles/assets/css/0.styles.82ef5590.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/my-articles/" class="home-link router-link-active"><img src="/my-articles/2022-03-24_115321.png" alt="不加冰" class="logo"> <span class="site-name can-hide">不加冰</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/my-articles/pages/leetcode/easy/001.两数之和.html" class="nav-link">
  力扣算法
</a></div><div class="nav-item"><a href="/my-articles/pages/studyNote/尚硅谷React.html" class="nav-link">
  学习笔记
</a></div><div class="nav-item"><a href="/my-articles/pages/data/队列结构.html" class="nav-link">
  数据结构
</a></div><div class="nav-item"><a href="/my-articles/pages/engineering/引入ESLint、Prettier、pre-commit.html" class="nav-link">
  前端工程化
</a></div><div class="nav-item"><a href="/my-articles/pages/vue/插槽、组件.html" class="nav-link">
  Vue学习
</a></div><div class="nav-item"><a href="/my-articles/pages/uniapp/uCharts地图标点.html" class="nav-link">
  uniapp
</a></div><div class="nav-item"><a href="/my-articles/pages/notes/01-2022年6月记.html" class="nav-link">
  随心记
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/my-articles/pages/leetcode/easy/001.两数之和.html" class="nav-link">
  力扣算法
</a></div><div class="nav-item"><a href="/my-articles/pages/studyNote/尚硅谷React.html" class="nav-link">
  学习笔记
</a></div><div class="nav-item"><a href="/my-articles/pages/data/队列结构.html" class="nav-link">
  数据结构
</a></div><div class="nav-item"><a href="/my-articles/pages/engineering/引入ESLint、Prettier、pre-commit.html" class="nav-link">
  前端工程化
</a></div><div class="nav-item"><a href="/my-articles/pages/vue/插槽、组件.html" class="nav-link">
  Vue学习
</a></div><div class="nav-item"><a href="/my-articles/pages/uniapp/uCharts地图标点.html" class="nav-link">
  uniapp
</a></div><div class="nav-item"><a href="/my-articles/pages/notes/01-2022年6月记.html" class="nav-link">
  随心记
</a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/my-articles/pages/studyNote/可视化与游戏.html" class="active sidebar-link">可视化与游戏</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/my-articles/pages/studyNote/可视化与游戏.html#canvas-2d" class="sidebar-link">Canvas 2d</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/my-articles/pages/studyNote/可视化与游戏.html#绘制线条" class="sidebar-link">绘制线条</a></li><li class="sidebar-sub-header"><a href="/my-articles/pages/studyNote/可视化与游戏.html#绘制文字" class="sidebar-link">绘制文字</a></li><li class="sidebar-sub-header"><a href="/my-articles/pages/studyNote/可视化与游戏.html#绘制矩形" class="sidebar-link">绘制矩形</a></li><li class="sidebar-sub-header"><a href="/my-articles/pages/studyNote/可视化与游戏.html#绘制圆" class="sidebar-link">绘制圆</a></li><li class="sidebar-sub-header"><a href="/my-articles/pages/studyNote/可视化与游戏.html#绘制图片" class="sidebar-link">绘制图片</a></li><li class="sidebar-sub-header"><a href="/my-articles/pages/studyNote/可视化与游戏.html#绘制刮刮卡效果" class="sidebar-link">绘制刮刮卡效果</a></li></ul></li><li class="sidebar-sub-header"><a href="/my-articles/pages/studyNote/可视化与游戏.html#webgl" class="sidebar-link">WebGL</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/my-articles/pages/studyNote/可视化与游戏.html#基础概念" class="sidebar-link">基础概念</a></li><li class="sidebar-sub-header"><a href="/my-articles/pages/studyNote/可视化与游戏.html#绘制单个像素点" class="sidebar-link">绘制单个像素点</a></li><li class="sidebar-sub-header"><a href="/my-articles/pages/studyNote/可视化与游戏.html#attribute-变量-绘制三角形" class="sidebar-link">attribute 变量 - 绘制三角形</a></li><li class="sidebar-sub-header"><a href="/my-articles/pages/studyNote/可视化与游戏.html#图形的偏移" class="sidebar-link">图形的偏移</a></li></ul></li><li class="sidebar-sub-header"><a href="/my-articles/pages/studyNote/可视化与游戏.html#three-js" class="sidebar-link">Three.js</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/my-articles/pages/studyNote/可视化与游戏.html#插件" class="sidebar-link">插件</a></li><li class="sidebar-sub-header"><a href="/my-articles/pages/studyNote/可视化与游戏.html#场景" class="sidebar-link">场景</a></li><li class="sidebar-sub-header"><a href="/my-articles/pages/studyNote/可视化与游戏.html#几何体" class="sidebar-link">几何体</a></li><li class="sidebar-sub-header"><a href="/my-articles/pages/studyNote/可视化与游戏.html#材质" class="sidebar-link">材质</a></li><li class="sidebar-sub-header"><a href="/my-articles/pages/studyNote/可视化与游戏.html#光照" class="sidebar-link">光照</a></li><li class="sidebar-sub-header"><a href="/my-articles/pages/studyNote/可视化与游戏.html#相机" class="sidebar-link">相机</a></li><li class="sidebar-sub-header"><a href="/my-articles/pages/studyNote/可视化与游戏.html#point-粒子" class="sidebar-link">Point 粒子</a></li><li class="sidebar-sub-header"><a href="/my-articles/pages/studyNote/可视化与游戏.html#导入模型" class="sidebar-link">导入模型</a></li><li class="sidebar-sub-header"><a href="/my-articles/pages/studyNote/可视化与游戏.html#动画" class="sidebar-link">动画</a></li></ul></li></ul></li><li><a href="/my-articles/pages/studyNote/尚硅谷React.html" class="sidebar-link">尚硅谷React</a></li><li><a href="/my-articles/pages/studyNote/慕课网大前端.html" class="sidebar-link">慕课网大前端</a></li><li><a href="/my-articles/pages/studyNote/开课吧web高级.html" class="sidebar-link">开课吧web高级</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="可视化与游戏-黑马在职加薪"><a href="#可视化与游戏-黑马在职加薪" class="header-anchor">#</a> 可视化与游戏 - 黑马在职加薪</h1> <blockquote><p>视频跟敲代码地址 <a href="https://gitee.com/noice-lee/visualization-and-games" target="_blank" rel="noopener noreferrer">码云<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></blockquote> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> cvs <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;cvs&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> cxt <span class="token operator">=</span> cvs<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">&quot;2d&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="canvas-2d"><a href="#canvas-2d" class="header-anchor">#</a> Canvas 2d</h2> <h3 id="绘制线条"><a href="#绘制线条" class="header-anchor">#</a> 绘制线条</h3> <ul><li><code>cxt.moveTo(x, y)</code> 定义一个开始坐标点</li> <li><code>cxt.lineTo(x, y)</code> 在当前坐标基础直线移动到目标点</li> <li><code>cxt.stroke()</code> 绘制当前路径</li> <li><code>cxt.closePath()</code> 闭合当前路径</li> <li><code>cxt.strokeStyle = 'color'</code> 设置绘制线条颜色</li> <li><code>cxt.lineWidth = Number</code> 设置绘制线条宽度</li> <li><code>cxt.beginPath()</code> 重置当前路径</li></ul> <div class="language-html line-numbers-mode"><pre class="language-html"><code>// 绘制不同线条颜色粗细的三角形
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>canvas</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>cvs<span class="token punctuation">&quot;</span></span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value css language-css"><span class="token property">border</span><span class="token punctuation">:</span> 1px solid #ccc<span class="token punctuation">;</span></span><span class="token punctuation">&quot;</span></span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>canvas</span><span class="token punctuation">&gt;</span></span>

  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
    <span class="token comment">// 获取上下文对象</span>
    <span class="token keyword">const</span> cvs <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;cvs&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> cxt <span class="token operator">=</span> cvs<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">&quot;2d&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 绘制第一条线</span>
    cxt<span class="token punctuation">.</span><span class="token function">moveTo</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    cxt<span class="token punctuation">.</span><span class="token function">lineTo</span><span class="token punctuation">(</span><span class="token number">90</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    cxt<span class="token punctuation">.</span>strokeStyle <span class="token operator">=</span> <span class="token string">&quot;red&quot;</span><span class="token punctuation">;</span>
    cxt<span class="token punctuation">.</span>lineWidth <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
    cxt<span class="token punctuation">.</span><span class="token function">stroke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    cxt<span class="token punctuation">.</span><span class="token function">beginPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 绘制第二条线</span>
    cxt<span class="token punctuation">.</span><span class="token function">moveTo</span><span class="token punctuation">(</span><span class="token number">90</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    cxt<span class="token punctuation">.</span><span class="token function">lineTo</span><span class="token punctuation">(</span><span class="token number">60</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    cxt<span class="token punctuation">.</span>strokeStyle <span class="token operator">=</span> <span class="token string">&quot;green&quot;</span><span class="token punctuation">;</span>
    cxt<span class="token punctuation">.</span>lineWidth <span class="token operator">=</span> <span class="token number">13</span><span class="token punctuation">;</span>
    cxt<span class="token punctuation">.</span><span class="token function">stroke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    cxt<span class="token punctuation">.</span><span class="token function">beginPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 绘制第三条线</span>
    cxt<span class="token punctuation">.</span><span class="token function">moveTo</span><span class="token punctuation">(</span><span class="token number">60</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    cxt<span class="token punctuation">.</span><span class="token function">lineTo</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    cxt<span class="token punctuation">.</span>strokeStyle <span class="token operator">=</span> <span class="token string">&quot;yellow&quot;</span><span class="token punctuation">;</span>
    cxt<span class="token punctuation">.</span>lineWidth <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>
    cxt<span class="token punctuation">.</span><span class="token function">stroke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    cxt<span class="token punctuation">.</span><span class="token function">beginPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br></div></div><h3 id="绘制文字"><a href="#绘制文字" class="header-anchor">#</a> 绘制文字</h3> <ul><li><code>cxt.fillText(text, x, y, [max])</code></li></ul> <p>填充式地绘制文字在指定坐标上，可指定最大宽度</p> <ul><li><code>cxt.strokeText()</code></li></ul> <p>描边式地绘制文字，参数与<code>fillText</code>相同</p> <ul><li><code>cxt.font = 'bold 20px 黑体'</code></li></ul> <p>设置绘制文字的样式</p> <ul><li><code>cxt.textAlign='水平方位值'</code></li></ul> <p>文字水平方向对其方式， center | middle | right 默认<strong>left</strong></p> <ul><li><code>cxt.textBaseline='垂直方位值'</code></li></ul> <p>文字垂直方向对其方式，top | middle | bottom 默认<strong>bottom</strong></p> <ul><li><code>cvs.toDataURL(type, options)</code></li></ul> <p>将绘制内容生成图片，type 为图片格式，如<code>image/png</code>，options 传入图片质量，范围 0 到 1</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> cvs <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;cvs&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> cxt <span class="token operator">=</span> cvs<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">&quot;2d&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 横向基准线</span>
cxt<span class="token punctuation">.</span><span class="token function">moveTo</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
cxt<span class="token punctuation">.</span><span class="token function">lineTo</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
cxt<span class="token punctuation">.</span><span class="token function">stroke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
cxt<span class="token punctuation">.</span><span class="token function">beginPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 纵向基准线</span>
cxt<span class="token punctuation">.</span><span class="token function">moveTo</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
cxt<span class="token punctuation">.</span><span class="token function">lineTo</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">130</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
cxt<span class="token punctuation">.</span><span class="token function">stroke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

cxt<span class="token punctuation">.</span>font <span class="token operator">=</span> <span class="token string">&quot;bold 30px 黑体&quot;</span><span class="token punctuation">;</span>
cxt<span class="token punctuation">.</span>textAlign <span class="token operator">=</span> <span class="token string">&quot;center&quot;</span><span class="token punctuation">;</span>
<span class="token comment">// cxt.textBaseline = 'bottom';</span>
cxt<span class="token punctuation">.</span><span class="token function">fillText</span><span class="token punctuation">(</span><span class="token string">&quot;fill Text&quot;</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 生成图片</span>
<span class="token keyword">const</span> img <span class="token operator">=</span> cvs<span class="token punctuation">.</span><span class="token function">toDataURL</span><span class="token punctuation">(</span><span class="token string">&quot;image/png&quot;</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>img<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><h3 id="绘制矩形"><a href="#绘制矩形" class="header-anchor">#</a> 绘制矩形</h3> <ul><li><code>cxt.rect(x, y, width, height)</code></li></ul> <p>绘制矩形路径</p> <ul><li><code>cxt.strokeRect(x, y, width, height)</code></li></ul> <p>绘制矩形边框</p> <ul><li><code>cxt.fillRect(x, y, width, height)</code></li></ul> <p>绘制填充矩形</p> <ul><li><code>cxt.clearRect(x, y, width, height)</code></li></ul> <p>清空指定矩形内像素</p> <h3 id="绘制圆"><a href="#绘制圆" class="header-anchor">#</a> 绘制圆</h3> <ul><li><code>cxt.arc(x, y, r, startAngle, endAngle, clockwise)</code></li></ul> <p>绘制圆形路径，角度须用<code>Math.PI</code>来表示 180 度，clockwise 代表是否逆时针绘制</p> <h3 id="绘制图片"><a href="#绘制图片" class="header-anchor">#</a> 绘制图片</h3> <ul><li><code>cxt.drawImage(img, x, y)</code></li></ul> <p>在指定位置绘制原图宽高的图片</p> <ul><li><code>cxt.drawImage(img, x,y ,w, h)</code></li></ul> <p>在指定位置绘制指定宽高的图片</p> <ul><li><code>cxt.drawImage(img, x1, y1, w1, h1, x2, y2, w2, h2)</code></li></ul> <p>截取图片上指定位置<code>(x1, y1)</code>指定宽高<code>(w1, h1)</code>，在到指定位置<code>(x2, y2)</code>,以指定宽高<code>(w2, h2)</code>绘制</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> cvs <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;cvs&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> cxt <span class="token operator">=</span> cvs<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">&quot;2d&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> img <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Image</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
img<span class="token punctuation">.</span>src <span class="token operator">=</span> <span class="token string">&quot;./imgs/1.png&quot;</span><span class="token punctuation">;</span>
img<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>img<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> w <span class="token operator">=</span> <span class="token number">1000</span><span class="token punctuation">;</span>
  <span class="token comment">// 按原图尺寸绘制</span>
  cxt<span class="token punctuation">.</span><span class="token function">drawImage</span><span class="token punctuation">(</span>img<span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 以指定尺寸绘制</span>
  cxt<span class="token punctuation">.</span><span class="token function">drawImage</span><span class="token punctuation">(</span>img<span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">320</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">320</span> <span class="token operator">*</span> img<span class="token punctuation">.</span>height<span class="token punctuation">)</span> <span class="token operator">/</span> img<span class="token punctuation">.</span>width<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 截取指定位置宽高 绘制到指定位置宽高</span>
  cxt<span class="token punctuation">.</span><span class="token function">drawImage</span><span class="token punctuation">(</span>img<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">300</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">300</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h3 id="绘制刮刮卡效果"><a href="#绘制刮刮卡效果" class="header-anchor">#</a> 绘制刮刮卡效果</h3> <ol><li>绘制中奖信息</li> <li>将 canvas 转换为图片设置为背景</li> <li>绘制灰色矩形框</li> <li>监听鼠标点击、鼠标移动、鼠标松起事件将鼠标位置变透明</li></ol> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> cvs <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;cvs&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> cxt <span class="token operator">=</span> cvs<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">&quot;2d&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 绘制中奖信息文本</span>
<span class="token keyword">const</span> priceList <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&quot;特等奖&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;一等奖&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;二等奖&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;三等奖&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;四等奖&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;鼓励奖&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> price <span class="token operator">=</span> priceList<span class="token punctuation">[</span>Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> priceList<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
cxt<span class="token punctuation">.</span>font <span class="token operator">=</span> <span class="token string">&quot;bold 40px 黑体&quot;</span><span class="token punctuation">;</span>
cxt<span class="token punctuation">.</span>textAlign <span class="token operator">=</span> <span class="token string">&quot;center&quot;</span><span class="token punctuation">;</span>
cxt<span class="token punctuation">.</span>textBaseline <span class="token operator">=</span> <span class="token string">&quot;middle&quot;</span><span class="token punctuation">;</span>
cxt<span class="token punctuation">.</span><span class="token function">fillText</span><span class="token punctuation">(</span>price<span class="token punctuation">,</span> cvs<span class="token punctuation">.</span>width <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">,</span> cvs<span class="token punctuation">.</span>height <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 将canvas转换为图片</span>
<span class="token keyword">const</span> img <span class="token operator">=</span> cvs<span class="token punctuation">.</span><span class="token function">toDataURL</span><span class="token punctuation">(</span><span class="token string">&quot;image/png&quot;</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 将canvas的背景设置为该图片</span>
cvs<span class="token punctuation">.</span>style<span class="token punctuation">.</span>background <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">url(</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>img<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">)</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>

<span class="token comment">// 绘制灰色矩形框</span>
cxt<span class="token punctuation">.</span><span class="token function">clearRect</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> cvs<span class="token punctuation">.</span>width<span class="token punctuation">,</span> cvs<span class="token punctuation">.</span>height<span class="token punctuation">)</span><span class="token punctuation">;</span>
cxt<span class="token punctuation">.</span>fillStyle <span class="token operator">=</span> <span class="token string">&quot;#aaa&quot;</span><span class="token punctuation">;</span>
cxt<span class="token punctuation">.</span><span class="token function">fillRect</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> cvs<span class="token punctuation">.</span>width<span class="token punctuation">,</span> cvs<span class="token punctuation">.</span>height<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 鼠标点击事件 设置一个属性，使绘制的东西变成透明</span>
<span class="token keyword">let</span> isDown <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
cvs<span class="token punctuation">.</span><span class="token function-variable function">onmousedown</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  isDown <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
  <span class="token comment">// 设置属性，使绘制的矩形是透明的</span>
  cxt<span class="token punctuation">.</span>globalCompositeOperation <span class="token operator">=</span> <span class="token string">&quot;destination-out&quot;</span><span class="token punctuation">;</span>
  cxt<span class="token punctuation">.</span><span class="token function">beginPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// 鼠标移动事件，绘制圆形或矩形</span>
cvs<span class="token punctuation">.</span><span class="token function-variable function">onmousemove</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>isDown<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    cxt<span class="token punctuation">.</span><span class="token function">fillRect</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>offsetX<span class="token punctuation">,</span> e<span class="token punctuation">.</span>offsetY<span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// 离开区域或鼠标抬起，停止绘制</span>
cvs<span class="token punctuation">.</span><span class="token function-variable function">onmouseleave</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  isDown <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
cvs<span class="token punctuation">.</span><span class="token function-variable function">onmouseup</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  isDown <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br></div></div><h2 id="webgl"><a href="#webgl" class="header-anchor">#</a> WebGL</h2> <h3 id="基础概念"><a href="#基础概念" class="header-anchor">#</a> 基础概念</h3> <h4 id="坐标体系"><a href="#坐标体系" class="header-anchor">#</a> 坐标体系</h4> <p>webgl 中坐标圆点是以 canvas 中心位置为圆点的</p> <h4 id="着色器"><a href="#着色器" class="header-anchor">#</a> 着色器</h4> <ul><li>记录像素点的<strong>位置</strong>和<strong>颜色</strong></li> <li>由<strong>顶点着色器</strong>和<strong>片段着色器</strong>组成</li></ul> <h3 id="绘制单个像素点"><a href="#绘制单个像素点" class="header-anchor">#</a> 绘制单个像素点</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 绘制像素单点</span>
<span class="token keyword">const</span> cvs <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;cvs&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> gl <span class="token operator">=</span> cvs<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">&quot;webgl&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 顶点着色器 记录位置</span>
<span class="token comment">/**
 * 定义点的坐标并转换成变量
 * vec4 是c语言中将输入值转换为矢量的方法
 *    四个值分别代表 x y z 坐标的值，范围是0到1， 第四个值站位，不起作用
 * gl_PointSize 设置缩放距离的直径 单位px
 */</span>
<span class="token keyword">const</span> <span class="token constant">VSHADER_SOURCE</span> <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
  void main() {
    gl_Position = vec4(0.0, 0.0, 0.0, 1.0);
    gl_PointSize = 10.0;
  }
</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>

<span class="token comment">// 片段着色器 记录颜色</span>
<span class="token comment">/**
 * 设置图形像素的颜色并保存
 * 四个值分别代表 r g b a 的值，范围0到1
 */</span>
<span class="token keyword">const</span> <span class="token constant">FSHADER_SOURCE</span> <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
  void main() {
    gl_FragColor = vec4(0.0, 1.0, 0.0, 1.0);
  }
</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>

<span class="token comment">// 新建一个用于存储顶点着色器的对象</span>
<span class="token keyword">const</span> vertShader <span class="token operator">=</span> gl<span class="token punctuation">.</span><span class="token function">createShader</span><span class="token punctuation">(</span>gl<span class="token punctuation">.</span><span class="token constant">VERTEX_SHADER</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 加载保存好的顶点着色器变量</span>
gl<span class="token punctuation">.</span><span class="token function">shaderSource</span><span class="token punctuation">(</span>vertShader<span class="token punctuation">,</span> <span class="token constant">VSHADER_SOURCE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 编译顶点着色器</span>
gl<span class="token punctuation">.</span><span class="token function">compileShader</span><span class="token punctuation">(</span>vertShader<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 新建一个用于存储片段着色器的对象</span>
<span class="token keyword">const</span> fragShader <span class="token operator">=</span> gl<span class="token punctuation">.</span><span class="token function">createShader</span><span class="token punctuation">(</span>gl<span class="token punctuation">.</span><span class="token constant">FRAGMENT_SHADER</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 加载保存好的片段着色器变量</span>
gl<span class="token punctuation">.</span><span class="token function">shaderSource</span><span class="token punctuation">(</span>fragShader<span class="token punctuation">,</span> <span class="token constant">FSHADER_SOURCE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 编译片段着色器</span>
gl<span class="token punctuation">.</span><span class="token function">compileShader</span><span class="token punctuation">(</span>fragShader<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 新建一个程序</span>
<span class="token keyword">const</span> shaderProgram <span class="token operator">=</span> gl<span class="token punctuation">.</span><span class="token function">createProgram</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 分别附加两个已编译好的着色器对象</span>
gl<span class="token punctuation">.</span><span class="token function">attachShader</span><span class="token punctuation">(</span>shaderProgram<span class="token punctuation">,</span> vertShader<span class="token punctuation">)</span><span class="token punctuation">;</span>
gl<span class="token punctuation">.</span><span class="token function">attachShader</span><span class="token punctuation">(</span>shaderProgram<span class="token punctuation">,</span> fragShader<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 链接两个附加好的着色器程序</span>
gl<span class="token punctuation">.</span><span class="token function">linkProgram</span><span class="token punctuation">(</span>shaderProgram<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 开启程序的使用</span>
gl<span class="token punctuation">.</span><span class="token function">useProgram</span><span class="token punctuation">(</span>shaderProgram<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 绘制指定位置的图形 第一个参数为绘制的类型 第二个参数开始的位置 第三个值是绘制的个数</span>
gl<span class="token punctuation">.</span><span class="token function">drawArraays</span><span class="token punctuation">(</span>gl<span class="token punctuation">.</span><span class="token constant">POINTS</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br></div></div><h3 id="attribute-变量-绘制三角形"><a href="#attribute-变量-绘制三角形" class="header-anchor">#</a> attribute 变量 - 绘制三角形</h3> <h4 id="什么是-attribute-变量"><a href="#什么是-attribute-变量" class="header-anchor">#</a> 什么是 attribute 变量</h4> <p>他是一种存储限定符，表示定义一个 attribute 的全局变量，这种变量的数据将由外部向顶点着色器内传输，并保存顶点相关的数据，只有顶点着色器才能使用它</p> <h4 id="使用-attribute-变量"><a href="#使用-attribute-变量" class="header-anchor">#</a> 使用 attribute 变量</h4> <ol><li>在顶点着色器中声明一个 attribute 变量</li> <li>将 attribute 变量赋值给 gl_Position 变量</li> <li>向 attribute 变量传输数据</li></ol> <h4 id="使用缓存区关联-attribute-变量"><a href="#使用缓存区关联-attribute-变量" class="header-anchor">#</a> 使用缓存区关联 attribute 变量</h4> <ol><li>创建缓存区对象</li> <li>绑定缓存区对象</li> <li>将数据写入对象</li> <li>将缓存区对象分配给 attribute 变量</li> <li>开启 attribute 变量</li></ol> <h4 id="代码"><a href="#代码" class="header-anchor">#</a> 代码</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 使用存储限定符定义一个接收顶点坐标的变量</span>
<span class="token keyword">const</span> <span class="token constant">VSHADER_SOURCE</span> <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
  attribute vec4 a_Position;
  void main() {
    gl_Position = a_Position;
    gl_PointSize = 10.0;
  }
</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>

<span class="token comment">// ... 相同代码省略</span>

<span class="token comment">// 开启程序的使用</span>
gl<span class="token punctuation">.</span><span class="token function">useProgram</span><span class="token punctuation">(</span>shaderProgram<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 定义一个类型数组保存顶点坐标值</span>
<span class="token keyword">var</span> vertices <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Float32Array</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.5</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 创建一个缓存对象</span>
<span class="token keyword">var</span> vertexBuffer <span class="token operator">=</span> gl<span class="token punctuation">.</span><span class="token function">createBuffer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 说明缓存对象保存的类型</span>
gl<span class="token punctuation">.</span><span class="token function">bindBuffer</span><span class="token punctuation">(</span>gl<span class="token punctuation">.</span><span class="token constant">ARRAY_BUFFER</span><span class="token punctuation">,</span> vertexBuffer<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 写入坐标属性</span>
gl<span class="token punctuation">.</span><span class="token function">bufferData</span><span class="token punctuation">(</span>gl<span class="token punctuation">.</span><span class="token constant">ARRAY_BUFFER</span><span class="token punctuation">,</span> vertices<span class="token punctuation">,</span> gl<span class="token punctuation">.</span><span class="token constant">STATIC_DRAW</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 获取顶点着色器中的变量</span>
<span class="token keyword">var</span> a_Position <span class="token operator">=</span> gl<span class="token punctuation">.</span><span class="token function">getAttribLocation</span><span class="token punctuation">(</span>shaderProgram<span class="token punctuation">,</span> <span class="token string">&quot;a_Position&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 将坐标值复制给变量</span>
gl<span class="token punctuation">.</span><span class="token function">vertexAttribPointer</span><span class="token punctuation">(</span>a_Position<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> gl<span class="token punctuation">.</span><span class="token constant">FLOAT</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//</span>
gl<span class="token punctuation">.</span><span class="token function">enableVertexAttribArray</span><span class="token punctuation">(</span>a_Position<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 绘制指定位置的图形 第一个参数为绘制的类型 第二个参数开始的位置 第三个值是绘制的个数</span>
gl<span class="token punctuation">.</span><span class="token function">drawArrays</span><span class="token punctuation">(</span>gl<span class="token punctuation">.</span><span class="token constant">TRIANGLES</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br></div></div><h3 id="图形的偏移"><a href="#图形的偏移" class="header-anchor">#</a> 图形的偏移</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 顶点着色器 记录位置</span>
<span class="token comment">// 使用存储限定符定义一个接收一致偏移量的变量</span>
<span class="token keyword">const</span> <span class="token constant">VSHADER_SOURCE</span> <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
  attribute vec4 a_Position;
  uniform vec4 u_Translation;
  void main() {
    gl_Position = a_Position + u_Translation;
    gl_PointSize = 10.0;
  }
</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>

<span class="token comment">// 片段着色器 记录颜色</span>
<span class="token keyword">const</span> <span class="token constant">FSHADER_SOURCE</span> <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
  void main() {
    gl_FragColor = vec4(0.0, 1.0, 0.0, 1.0);
  }
</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>

<span class="token comment">// 新建一个用于存储顶点着色器的对象</span>
<span class="token keyword">const</span> vertShader <span class="token operator">=</span> gl<span class="token punctuation">.</span><span class="token function">createShader</span><span class="token punctuation">(</span>gl<span class="token punctuation">.</span><span class="token constant">VERTEX_SHADER</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 加载保存好的顶点着色器变量</span>
gl<span class="token punctuation">.</span><span class="token function">shaderSource</span><span class="token punctuation">(</span>vertShader<span class="token punctuation">,</span> <span class="token constant">VSHADER_SOURCE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 编译顶点着色器</span>
gl<span class="token punctuation">.</span><span class="token function">compileShader</span><span class="token punctuation">(</span>vertShader<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 新建一个用于存储片段着色器的对象</span>
<span class="token keyword">const</span> fragShader <span class="token operator">=</span> gl<span class="token punctuation">.</span><span class="token function">createShader</span><span class="token punctuation">(</span>gl<span class="token punctuation">.</span><span class="token constant">FRAGMENT_SHADER</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 加载保存好的片段着色器变量</span>
gl<span class="token punctuation">.</span><span class="token function">shaderSource</span><span class="token punctuation">(</span>fragShader<span class="token punctuation">,</span> <span class="token constant">FSHADER_SOURCE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 编译片段着色器</span>
gl<span class="token punctuation">.</span><span class="token function">compileShader</span><span class="token punctuation">(</span>fragShader<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 新建一个程序</span>
<span class="token keyword">const</span> shaderProgram <span class="token operator">=</span> gl<span class="token punctuation">.</span><span class="token function">createProgram</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 分别附加两个已编译好的着色器对象</span>
gl<span class="token punctuation">.</span><span class="token function">attachShader</span><span class="token punctuation">(</span>shaderProgram<span class="token punctuation">,</span> vertShader<span class="token punctuation">)</span><span class="token punctuation">;</span>
gl<span class="token punctuation">.</span><span class="token function">attachShader</span><span class="token punctuation">(</span>shaderProgram<span class="token punctuation">,</span> fragShader<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 链接两个附加好的着色器程序</span>
gl<span class="token punctuation">.</span><span class="token function">linkProgram</span><span class="token punctuation">(</span>shaderProgram<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 开启程序的使用</span>
gl<span class="token punctuation">.</span><span class="token function">useProgram</span><span class="token punctuation">(</span>shaderProgram<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 定义一个类型数组保存顶点坐标值</span>
<span class="token keyword">var</span> vertices <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Float32Array</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.5</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 创建一个缓存对象</span>
<span class="token keyword">var</span> vertexBuffer <span class="token operator">=</span> gl<span class="token punctuation">.</span><span class="token function">createBuffer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 说明缓存对象保存的类型</span>
gl<span class="token punctuation">.</span><span class="token function">bindBuffer</span><span class="token punctuation">(</span>gl<span class="token punctuation">.</span><span class="token constant">ARRAY_BUFFER</span><span class="token punctuation">,</span> vertexBuffer<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 写入坐标属性</span>
gl<span class="token punctuation">.</span><span class="token function">bufferData</span><span class="token punctuation">(</span>gl<span class="token punctuation">.</span><span class="token constant">ARRAY_BUFFER</span><span class="token punctuation">,</span> vertices<span class="token punctuation">,</span> gl<span class="token punctuation">.</span><span class="token constant">STATIC_DRAW</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 获取顶点着色器中的变量</span>
<span class="token keyword">var</span> a_Position <span class="token operator">=</span> gl<span class="token punctuation">.</span><span class="token function">getAttribLocation</span><span class="token punctuation">(</span>shaderProgram<span class="token punctuation">,</span> <span class="token string">&quot;a_Position&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 将坐标值复制给变量</span>
gl<span class="token punctuation">.</span><span class="token function">vertexAttribPointer</span><span class="token punctuation">(</span>a_Position<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> gl<span class="token punctuation">.</span><span class="token constant">FLOAT</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//</span>
gl<span class="token punctuation">.</span><span class="token function">enableVertexAttribArray</span><span class="token punctuation">(</span>a_Position<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 定义各坐标点的统一偏移量</span>
<span class="token keyword">const</span> Tx <span class="token operator">=</span> <span class="token number">0.2</span><span class="token punctuation">,</span>
  Ty <span class="token operator">=</span> <span class="token number">0.5</span><span class="token punctuation">,</span>
  Tz <span class="token operator">=</span> <span class="token number">0.0</span><span class="token punctuation">;</span>
<span class="token comment">// 获取顶点着色器中uniform变量</span>
<span class="token keyword">const</span> u_Translation <span class="token operator">=</span> gl<span class="token punctuation">.</span><span class="token function">getUniformLocation</span><span class="token punctuation">(</span>shaderProgram<span class="token punctuation">,</span> <span class="token string">&quot;u_Translation&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 将多个偏移量赋值给uniform变量</span>
gl<span class="token punctuation">.</span><span class="token function">uniform4f</span><span class="token punctuation">(</span>u_Translation<span class="token punctuation">,</span> Tx<span class="token punctuation">,</span> Ty<span class="token punctuation">,</span> Tz<span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 绘制指定位置的图形 第一个参数为绘制的类型 第二个参数开始的位置 第三个值是绘制的个数</span>
gl<span class="token punctuation">.</span><span class="token function">drawArrays</span><span class="token punctuation">(</span>gl<span class="token punctuation">.</span><span class="token constant">TRIANGLES</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br></div></div><h2 id="three-js"><a href="#three-js" class="header-anchor">#</a> Three.js</h2> <p>三要素：渲染器、场景、相机</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token comment">&lt;!-- hello world案例 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span> <span class="token special-attr"><span class="token attr-name">onload</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value javascript language-javascript"><span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span><span class="token punctuation">&quot;</span></span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>https://cdn.bootcdn.net/ajax/libs/three.js/0.147.0/three.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>

  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
    <span class="token keyword">var</span> renderer<span class="token punctuation">,</span> camera<span class="token punctuation">,</span> scene<span class="token punctuation">,</span> geometry<span class="token punctuation">,</span> material<span class="token punctuation">,</span> mesh<span class="token punctuation">;</span>

    <span class="token keyword">function</span> <span class="token function">initRenderer</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      renderer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>WebGLRenderer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      renderer<span class="token punctuation">.</span><span class="token function">setSize</span><span class="token punctuation">(</span>window<span class="token punctuation">.</span>innerWidth<span class="token punctuation">,</span> window<span class="token punctuation">.</span>innerHeight<span class="token punctuation">)</span><span class="token punctuation">;</span>
      document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>renderer<span class="token punctuation">.</span>domElement<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">function</span> <span class="token function">initScene</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      scene <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Scene</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">function</span> <span class="token function">initCamera</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// z 轴朝向屏幕前自己</span>
      <span class="token comment">// 相机视野的宽度</span>
      <span class="token comment">// 宽高比</span>
      <span class="token comment">// 近裁面和远裁面</span>
      camera <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>PerspectiveCamera</span><span class="token punctuation">(</span>
        <span class="token number">45</span><span class="token punctuation">,</span>
        window<span class="token punctuation">.</span>innerWidth <span class="token operator">/</span> window<span class="token punctuation">.</span>innerHeight<span class="token punctuation">,</span>
        <span class="token number">0.1</span><span class="token punctuation">,</span>
        <span class="token number">200</span>
      <span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// x y z</span>
      camera<span class="token punctuation">.</span>position<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">function</span> <span class="token function">initMesh</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 创建几何体</span>
      geometry <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>BoxGeometry</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// 创建材质 七彩材质</span>
      materia <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>MeshNormalMaterial</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token comment">// 创建网格</span>
      mesh <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Mesh</span><span class="token punctuation">(</span>geometry<span class="token punctuation">,</span> materia<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// 将网格添加到场景</span>
      scene<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>mesh<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">function</span> <span class="token function">animate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">requestAnimationFrame</span><span class="token punctuation">(</span>animate<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// x轴旋转0.01弧度 半圈是180度</span>
      mesh<span class="token punctuation">.</span>rotation<span class="token punctuation">.</span>x <span class="token operator">+=</span> <span class="token number">0.01</span><span class="token punctuation">;</span>
      <span class="token comment">// y轴旋转0.02弧度</span>
      mesh<span class="token punctuation">.</span>rotation<span class="token punctuation">.</span>y <span class="token operator">+=</span> <span class="token number">0.02</span><span class="token punctuation">;</span>

      renderer<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>scene<span class="token punctuation">,</span> camera<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">function</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">initRenderer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 渲染器</span>
      <span class="token function">initScene</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 场景</span>
      <span class="token function">initCamera</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 相机</span>

      <span class="token function">initMesh</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">animate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br></div></div><h3 id="插件"><a href="#插件" class="header-anchor">#</a> 插件</h3> <ul><li>监控性能插件 <code>stats</code></li> <li>调试插件 <code>dat-GUI</code></li></ul> <h3 id="场景"><a href="#场景" class="header-anchor">#</a> 场景</h3> <h4 id="介绍"><a href="#介绍" class="header-anchor">#</a> 介绍</h4> <p>放置内容的容器，也可以定义多个场景进行切换，场景内可放置灯光、模型、相机，场景也可调整位置</p> <h4 id="three-object3d"><a href="#three-object3d" class="header-anchor">#</a> THREE.Object3D</h4> <p>为了方便操作，Three.js 将每个能够添加到场景内的对象都继承自一个基类<code>THREE.Object3D</code></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 判断对象是否继承自基类</span>
obj instanceOf <span class="token constant">THREE</span><span class="token punctuation">.</span>Object3D<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h4 id="向场景内添加一个-3d-对象"><a href="#向场景内添加一个-3d-对象" class="header-anchor">#</a> 向场景内添加一个 3d 对象</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 将网格添加到场景</span>
scene<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>mesh<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 还可将一个3d对象添加另外一个3d对象中</span>
parent<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>child<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h4 id="获取一个对象"><a href="#获取一个对象" class="header-anchor">#</a> 获取一个对象</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 给3D对象命名</span>
object3D<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&quot;ljb&quot;</span><span class="token punctuation">;</span>
<span class="token comment">// 添加3D对象到场景</span>
scene<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>object3D<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 获取3D对象</span>
scene<span class="token punctuation">.</span><span class="token function">getObjectByName</span><span class="token punctuation">(</span><span class="token string">&quot;ljb&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h4 id="隐藏和删除"><a href="#隐藏和删除" class="header-anchor">#</a> 隐藏和删除</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 将3D对象的可见属性设置为false即可隐藏</span>
object3D<span class="token punctuation">.</span>visible <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>

<span class="token comment">// 调用父身上的remove可实现删除</span>
scene<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>object3D<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h4 id="位移和拉伸"><a href="#位移和拉伸" class="header-anchor">#</a> 位移和拉伸</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 单独设置某方向</span>
mesh<span class="token punctuation">.</span>position<span class="token punctuation">.</span>x <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>
mesh<span class="token punctuation">.</span>position<span class="token punctuation">.</span>y <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>
mesh<span class="token punctuation">.</span>position<span class="token punctuation">.</span>z <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>

<span class="token comment">// 一次性修改</span>
mesh<span class="token punctuation">.</span>position<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 单独修改某方向拉伸</span>
mesh<span class="token punctuation">.</span>scale<span class="token punctuation">.</span>x <span class="token operator">=</span> <span class="token number">0.5</span><span class="token punctuation">;</span>
mesh<span class="token punctuation">.</span>scale<span class="token punctuation">.</span>y <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
mesh<span class="token punctuation">.</span>scale<span class="token punctuation">.</span>z <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token comment">// 一次性修改</span>
mesh<span class="token punctuation">.</span>scale<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h3 id="几何体"><a href="#几何体" class="header-anchor">#</a> 几何体</h3> <p>模型是由几何体<code>Geometry</code>和材质<code>material</code>构成</p> <h4 id="几何体和二进制几何体"><a href="#几何体和二进制几何体" class="header-anchor">#</a> 几何体和二进制几何体</h4> <p>Three.js 内置两种几何体类型<code>Geometry</code>和<code>BufferGeometry</code>，两种几何体类型都是用于存储模型的顶点位置、面的索引、法向量、颜色、uv 纹理以及一些自定义的属性。</p> <h4 id="两者区别"><a href="#两者区别" class="header-anchor">#</a> 两者区别</h4> <ul><li>Geometry
<ul><li>使用了 Three.js 提供的 THREE.Vetor3 或者 THREE.Color 这样的对象来存储数据</li> <li>易于阅读和编辑</li> <li>性能弱一些</li> <li>适合动画场景</li></ul></li> <li>BufferGeometry
<ul><li>存储数据原始</li> <li>不易阅读和编辑</li> <li>性能好</li> <li>适合存储一些放入场景内不需要再额外操作的模型</li></ul></li></ul> <h4 id="互转"><a href="#互转" class="header-anchor">#</a> 互转</h4> <ul><li>BufferGeometry 转换成 Geometry</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 实例化一个Geometry对象</span>
<span class="token keyword">var</span> geo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Geometry</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 调用对象的方法，传入需要转换的bufferGeometry实例对象</span>
geo<span class="token punctuation">.</span><span class="token function">fromBufferGeometry</span><span class="token punctuation">(</span>bufferGeometry<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li>Geometry 转换成 BufferGeometry</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 实例化一个BufferGeo对象</span>
<span class="token keyword">var</span> bufferGeo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>BufferGeometry</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 调用对象的方法，传入geometry实例</span>
bufferGeo<span class="token punctuation">.</span><span class="token function">fromGeometry</span><span class="token punctuation">(</span>geometry<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h4 id="立方体"><a href="#立方体" class="header-anchor">#</a> 立方体</h4> <p>在 WebGL 中，所有的模型都是通过三角形面组成的。</p> <h5 id="创建"><a href="#创建" class="header-anchor">#</a> 创建</h5> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 创建形状</span>
<span class="token keyword">var</span> geometry <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Boxgeometry</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 创建材质</span>
<span class="token keyword">var</span> material <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>MeshBasicMaterial</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token number">0x00ff00</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 组合到一块</span>
<span class="token keyword">var</span> cube <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Mesh</span><span class="token punctuation">(</span>getmetry<span class="token punctuation">,</span> material<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h5 id="构造函数"><a href="#构造函数" class="header-anchor">#</a> 构造函数</h5> <p><code>THREE.Boxgeometry(width, height, depth, [widthSegments, heightSegments, depthSegments])</code></p> <ul><li>width - x 轴的宽度，默认值为 1</li> <li>height - y 轴的高度，默认值为 1</li> <li>depth - z 轴的深度，默认值为 1</li> <li>widthSegments - 可选，x 轴宽度的分割的数量，默认值为 1</li> <li>heightSegments - 可选，y 轴高度的分割面的数量，默认值为 1</li> <li>depthSegments - 可选，z 轴深度的分割面的数量，默认值是 1</li></ul> <p>分割面数量的意思是，在某个方向将几何体切成对应数量块，类似切西瓜</p> <h4 id="圆形"><a href="#圆形" class="header-anchor">#</a> 圆形</h4> <p>圆形是由多个三角形分段构成</p> <h5 id="创建-2"><a href="#创建-2" class="header-anchor">#</a> 创建</h5> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> geometry <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>CircleGeometry</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> material <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>MeshBasicMaterial</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token number">0xffff00</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> circle <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Mesh</span><span class="token punctuation">(</span>geometry<span class="token punctuation">,</span> material<span class="token punctuation">)</span><span class="token punctuation">;</span>
scene<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>circle<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h5 id="构造函数-2"><a href="#构造函数-2" class="header-anchor">#</a> 构造函数</h5> <p><code>CircleGeometry(redius, segment, thetaStart, thetaLength)</code></p> <ul><li>radius - 圆的半径，默认值为 1</li> <li>segments - 段数（多少个三角形组成），最小值为 3，默认值是 8</li> <li>thetaStart - 第一段的起始角度，默认值为 0</li> <li>thetaLength - 圆形善心的中心角，默认值是 <code>2 * PI</code>，画出一个整</li></ul> <h4 id="圆锥"><a href="#圆锥" class="header-anchor">#</a> 圆锥</h4> <h4 id="圆柱"><a href="#圆柱" class="header-anchor">#</a> 圆柱</h4> <h4 id="球"><a href="#球" class="header-anchor">#</a> 球</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> geometry <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>SphereGeometry</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> material <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>MeshBasicMaterial</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">color</span><span class="token operator">:</span> oxffffff <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> sphere <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>mesh</span><span class="token punctuation">(</span>geometry<span class="token punctuation">,</span> material<span class="token punctuation">)</span><span class="token punctuation">;</span>
scene<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>sphere<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><code>SphereGeometry(radius, widthSegments, heightSegments, phiStart, phiLength, thetaStart, thetaLength)</code></p> <ul><li>radius 球体半径，默认是 1</li> <li>widthSegments 水平线断数量，最小值为 3，默认 6</li> <li>heightSegments 垂直段的数量，最小值 2，默认 6</li> <li>phiLength 指定水平渲染角度大小，默认 Math.PI * 2</li> <li>thetaStart 指定垂直渲染启示角度，默认 0</li> <li>thetaLength 指定垂直渲染角度大小，默认 Math.PI</li></ul> <h4 id="平面"><a href="#平面" class="header-anchor">#</a> 平面</h4> <h4 id="圆环"><a href="#圆环" class="header-anchor">#</a> 圆环</h4> <h3 id="材质"><a href="#材质" class="header-anchor">#</a> 材质</h3> <p>模型的外观</p> <h4 id="meshbasicmaterial"><a href="#meshbasicmaterial" class="header-anchor">#</a> MeshBasicMaterial</h4> <p>简单材质，不会受到光的影响，直接看到的效果就是整个物体都是一个颜色的，没有立体的感觉</p> <ol><li>初始化</li></ol> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 定义材质和颜色</span>
<span class="token keyword">var</span> material <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>MeshBasicMaterial</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token number">0x00ffff</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 定义形状</span>
<span class="token keyword">var</span> geometry <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>BoxGeometry</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
mesh <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Mesh</span><span class="token punctuation">(</span>geometry<span class="token punctuation">,</span> material<span class="token punctuation">)</span><span class="token punctuation">;</span>
scene<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>mesh<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><ol start="2"><li>修改 color</li></ol> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 使用set修改</span>
material<span class="token punctuation">.</span>color<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token number">0xff00ff</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 直接赋值一个新的THREE.Color对象</span>
meterial<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Color</span><span class="token punctuation">(</span><span class="token number">0xff00ff</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h4 id="meshnormalmaterial"><a href="#meshnormalmaterial" class="header-anchor">#</a> MeshNormalMaterial</h4> <p>这种材质会根据面的方向不同自动改变颜色，不受灯光影响</p> <p><code>new THREE.MeshNormalMaterial()</code> 不用传入颜色</p> <p><code>LineBasicMaterial</code></p> <p>线条材质，需指定两个点，起点和终点</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 定义点位</span>
<span class="token keyword">var</span> pointsArr <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Vector3</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Vector3</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Vector3</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Vector3</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token comment">// 实例化几何体 并设置点位</span>
<span class="token keyword">var</span> lineGeometry <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>BufferGeometry</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
lineGeometry<span class="token punctuation">.</span><span class="token function">setFromPoints</span><span class="token punctuation">(</span>pointsArr<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 定义材质传入材质</span>
<span class="token keyword">var</span> lineMaterial <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>LineBasicMaterial</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token number">0x00ffff</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> line <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Line</span><span class="token punctuation">(</span>lineGeometry<span class="token punctuation">,</span> lineMaterial<span class="token punctuation">)</span><span class="token punctuation">;</span>
scene<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>line<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><h4 id="受光的影响的材质"><a href="#受光的影响的材质" class="header-anchor">#</a> 受光的影响的材质</h4> <ul><li>MeshLambertMaterial 兰伯特材质</li> <li>MeshPhongMaterial 高光材质</li></ul> <p>对光有反映，但是不会出现高光，模拟一些粗糙材质的物品，比如木头、石头</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 创建几何体</span>
geometry <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>BoxGeometry</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 兰伯特材质</span>
material <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>MeshLambertMaterial</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token number">0x00ffff</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 高光材质</span>
material <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>MeshPhongMaterial</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token number">0x00ffff</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

mesh <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Mesh</span><span class="token punctuation">(</span>geometry<span class="token punctuation">,</span> material<span class="token punctuation">)</span><span class="token punctuation">;</span>
scene<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>mesh<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h3 id="光照"><a href="#光照" class="header-anchor">#</a> 光照</h3> <h4 id="创建和修改"><a href="#创建和修改" class="header-anchor">#</a> 创建和修改</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 添加一个白色的平行光 一个参数是颜色，一个参数是强度</span>
<span class="token keyword">var</span> light <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>DirectionalLight</span><span class="token punctuation">(</span><span class="token number">0xffffff</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 修改颜色和强度</span>
light<span class="token punctuation">.</span>color<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token number">0x000000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
light<span class="token punctuation">.</span>intensity <span class="token operator">=</span> <span class="token number">2.0</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h4 id="ambientlight-环境全局光"><a href="#ambientlight-环境全局光" class="header-anchor">#</a> AmbientLight 环境全局光</h4> <p>环境光会照亮场景中所有的物体，在计算物体的颜色时，都会叠加上环境光的颜色（类似漫反射产生的光）</p> <p>环境光作用域所有物体，所有的材质，所以环境光是没有方向的，无法产生阴影</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>scene<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>AmbientLight</span><span class="token punctuation">(</span><span class="token number">0x222222</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="directionallight-平行光"><a href="#directionallight-平行光" class="header-anchor">#</a> DirectionalLight 平行光</h4> <p>产生的光都是平行状态，主要用于模拟太阳光，接收两个值，颜色和光线强度，代码见创建和修改光照</p> <h4 id="添加阴影效果"><a href="#添加阴影效果" class="header-anchor">#</a> 添加阴影效果</h4> <p>平行光可以产生投影效果，需要以下步骤才可产生阴影效果</p> <ol><li>将渲染器设置为可以渲染阴影效果</li></ol> <div class="language-js line-numbers-mode"><pre class="language-js"><code>render<span class="token punctuation">.</span>shadowMap<span class="token punctuation">.</span>enabled <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ol start="2"><li>实例化灯光时，需设置灯光渲染阴影</li></ol> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 创建平行光</span>
directionalLight <span class="token operator">=</span> newe <span class="token constant">THREE</span><span class="token punctuation">.</span><span class="token function">DirectionalLight</span><span class="token punctuation">(</span><span class="token string">'#ffffff'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 设置渲染阴影</span>
directionalLight<span class="token punctuation">.</span>castShadow <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>

scene<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>directionalLight<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><ol start="3"><li>设置模型哪些需要产生阴影(哪个有遮挡效果)</li></ol> <div class="language-js line-numbers-mode"><pre class="language-js"><code>sphere<span class="token punctuation">.</span>castShadow <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
scene<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>sphere<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ol start="4"><li>设置哪些模型可以接收阴影(阴影可投射到哪)</li></ol> <div class="language-js line-numbers-mode"><pre class="language-js"><code>plane<span class="token punctuation">.</span>receiveShadow <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
scene<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>sphere<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>渲染阴影非常耗费性能，所以需要设置合适的参数</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 产生阴影的最近距离(在距离内才可产生阴影)</span>
directionalLight<span class="token punctuation">.</span>shadow<span class="token punctuation">.</span>near <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span>
<span class="token comment">// 产生阴影的最远距离</span>
directionalLight<span class="token punctuation">.</span>shadow<span class="token punctuation">.</span>far <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span>
<span class="token comment">// 产生阴影的最左边位置</span>
directionalLight<span class="token punctuation">.</span>shadow<span class="token punctuation">.</span>left <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span>
<span class="token comment">// 最右边位置</span>
directionalLight<span class="token punctuation">.</span>shadow<span class="token punctuation">.</span>rihgt <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span>
<span class="token comment">// 最上</span>
directionalLight<span class="token punctuation">.</span>shadow<span class="token punctuation">.</span>top <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span>
<span class="token comment">// 最下</span>
directionalLight<span class="token punctuation">.</span>shadow<span class="token punctuation">.</span>bottom <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h4 id="点光源"><a href="#点光源" class="header-anchor">#</a> 点光源</h4> <p>从一个点的位置向四面八方射出去的光，比如灯泡</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 光照颜色 光照强度 照射范围 衰减度</span>
<span class="token keyword">var</span> pointLight <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>PointLight</span><span class="token punctuation">(</span><span class="token number">0xff0000</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
pointLight<span class="token punctuation">.</span>position<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
scene<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>pointLight<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 修改参数</span>
pointLight<span class="token punctuation">.</span>color<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token number">0x000000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
pointLight<span class="token punctuation">.</span>intensity <span class="token operator">=</span> <span class="token number">0.5</span><span class="token punctuation">;</span>
pointLight<span class="token punctuation">.</span>distance <span class="token operator">=</span> <span class="token number">50</span><span class="token punctuation">;</span>
pointLight<span class="token punctuation">.</span>decay <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h4 id="spotlight-聚光灯"><a href="#spotlight-聚光灯" class="header-anchor">#</a> SpotLight 聚光灯</h4> <p>由一个点发出的光线，沿着一个圆锥体进行照射，可模仿手电筒，舞台聚光灯</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 颜色 强度 照射范围 锥体大小(照射面的圆的大小) 渐变过渡大小(0 ~ 1) 衰减度</span>
<span class="token keyword">var</span> spotLight <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>SpotLight</span><span class="token punctuation">(</span><span class="token number">0xff0000</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">/</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 修改参数</span>
spotLight<span class="token punctuation">.</span>color<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token number">0x000000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
spotLight<span class="token punctuation">.</span>intensity <span class="token operator">=</span> <span class="token number">0.5</span><span class="token punctuation">;</span>
spotLight<span class="token punctuation">.</span>distance <span class="token operator">=</span> <span class="token number">50</span><span class="token punctuation">;</span>
spotLight<span class="token punctuation">.</span>angle <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">/</span> <span class="token number">3</span><span class="token punctuation">;</span>
spotLight<span class="token punctuation">.</span>penumbra <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
spotLight<span class="token punctuation">.</span>decay <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h4 id="hemisperelight-室外光源"><a href="#hemisperelight-室外光源" class="header-anchor">#</a> HemispereLight 室外光源</h4> <p>模拟户外的环境光效果，如蓝天绿地的户外，模型下面会显出绿色的环境光，上方会受到蓝天的影响而偏蓝</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 天空的颜色 地面的颜色 光照强度</span>
<span class="token keyword">var</span> hemisphereLight <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>HemispereLight</span><span class="token punctuation">(</span><span class="token number">0xff0000</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">/</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 修改</span>
hemisphereLight<span class="token punctuation">.</span>color<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token number">0xffffff</span><span class="token punctuation">)</span> <span class="token comment">// 修改天空的颜色</span>
hemisphereLight。groundColor<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token number">0x000000</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 修改地面的颜色</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h3 id="相机"><a href="#相机" class="header-anchor">#</a> 相机</h3> <p>常用的相机有正交相机（OrthographicCamera）和透视相机（PerspectiveCamera）两种，有一些通用的属性和方法</p> <h4 id="target-焦点属性和-lookat-方法"><a href="#target-焦点属性和-lookat-方法" class="header-anchor">#</a> target 焦点属性和 lookAt 方法</h4> <p>都是台哦正相机的朝向的</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>camera<span class="token punctuation">.</span>target <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Vector3</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
camera<span class="token punctuation">.</span><span class="token function">lookAt</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Vector3</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><blockquote><p>小技巧：可以将相机朝向改为模型的 position，则当物体移动时，相机的焦点也会跟着移动 <code>camera.target = mesh.position</code></p></blockquote> <h4 id="orthographiccamera-正交相机"><a href="#orthographiccamera-正交相机" class="header-anchor">#</a> OrthographicCamera 正交相机</h4> <p>使用这个叫相机渲染出来的场景，所有的物体和模型都按照它固有的尺寸和精度显示，不会有近处大远处小的立体感效果，一般用在 2D 平面中</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> orthographicCamera <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>OrthographicCamera</span><span class="token punctuation">(</span>
  left<span class="token punctuation">,</span>
  right<span class="token punctuation">,</span>
  top<span class="token punctuation">,</span>
  bottom<span class="token punctuation">,</span>
  near<span class="token punctuation">,</span>
  far
<span class="token punctuation">)</span><span class="token punctuation">;</span>

scene<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>orthographicCamera<span class="token punctuation">)</span><span class="token punctuation">;</span>

orthographicCamera<span class="token punctuation">.</span>left <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
orthographicCamera<span class="token punctuation">.</span>right <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
orthographicCamera<span class="token punctuation">.</span>top <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
orthographicCamera<span class="token punctuation">.</span>bottom <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
orthographicCamera<span class="token punctuation">.</span>near <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
orthographicCamera<span class="token punctuation">.</span>far <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>

<span class="token comment">// 需调用方法进行更新</span>
orthographicCamera<span class="token punctuation">.</span><span class="token function">updateProjectionMatrix</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><h4 id="perspectivecamera-透视相机"><a href="#perspectivecamera-透视相机" class="header-anchor">#</a> PerspectiveCamera 透视相机</h4> <p>模拟人眼视角的一种相机，渲染出 3d 效果</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 相机可视角度 宽高比 最近距离 最远距离</span>
<span class="token keyword">var</span> perspectiveCamera <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>PerspectiveCamera</span><span class="token punctuation">(</span>fov<span class="token punctuation">,</span> aspect<span class="token punctuation">,</span> near<span class="token punctuation">,</span> far<span class="token punctuation">)</span><span class="token punctuation">;</span>
scene<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>perspectiveCamera<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 修改同正交相机，修改后也需调用方法进行更新</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h4 id="orbitcontrols-相机旋转缩放插件"><a href="#orbitcontrols-相机旋转缩放插件" class="header-anchor">#</a> OrbitControls 相机旋转缩放插件</h4> <p>可提供使用鼠标控制相机旋转缩放的功能</p> <ol><li>引入<code>OrbitControls</code>对象<code>https://github.com/mrdoob/three.js/blob/dev/examples/jsm/controls/OrbitControls.js</code></li> <li>初始化控制器 <code>var orbitControls = new window.OrbitControls(camera, renderer.domElement);</code></li></ol> <h3 id="point-粒子"><a href="#point-粒子" class="header-anchor">#</a> Point 粒子</h3> <p>可实现雨雪、烟雾、星空等效果</p> <h4 id="sprite-精灵"><a href="#sprite-精灵" class="header-anchor">#</a> Sprite 精灵</h4> <p>继承与 THREE.Object3D 的子类，所以操作模型网格的属性和方法也适用于精灵，精灵没有阴影效果</p> <ol><li>普通精灵</li></ol> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> spriteMaterialNormal <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>SpriteMaterial</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token number">0xffffff</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> spriteNormal <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Sprite</span><span class="token punctuation">(</span>spriteMaterialNormal<span class="token punctuation">)</span><span class="token punctuation">;</span>
spriteNormal<span class="token punctuation">.</span>position<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">2.6</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
spriteNormal<span class="token punctuation">.</span>scale<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
scene<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>spriteNormal<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><ol start="2"><li>图片导入</li></ol> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// base64格式或图片路径</span>
<span class="token keyword">var</span> spriteMap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>TextureLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span><span class="token string">&quot;./imgs/qiu.png&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> sp1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Sprite</span><span class="token punctuation">(</span>
  <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>SpriteMaterial</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">map</span><span class="token operator">:</span> spriteMap<span class="token punctuation">,</span>
    <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token number">0xafaafa</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
sp1<span class="token punctuation">.</span>position<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
sp1<span class="token punctuation">.</span>scale<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
scene<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>sp1<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h4 id="粒子"><a href="#粒子" class="header-anchor">#</a> 粒子</h4> <p>视频缺失，等学下一部视频时再看吧</p> <h3 id="导入模型"><a href="#导入模型" class="header-anchor">#</a> 导入模型</h3> <p>模型制作工具：</p> <ul><li>3d max</li> <li>SketchUp</li></ul> <h4 id="json-格式"><a href="#json-格式" class="header-anchor">#</a> JSON 格式</h4> <p>一般用域官方的 editor 导出，其内部一般必有的四项为：</p> <ul><li>metadata 当前模型的相关信息以及生成的工具信息</li> <li>geometries 所使用的几何体的数组</li> <li>materials 所使用的材质的数组</li> <li>object 模型的结构以及标示所应用到的材质和几何体标示</li></ul> <h4 id="_3d-对象转成-json"><a href="#_3d-对象转成-json" class="header-anchor">#</a> 3d 对象转成 JSON</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> obj <span class="token operator">=</span> scene<span class="token punctuation">.</span><span class="token function">toJSON</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 整个场景转换为json对象</span>
<span class="token keyword">var</span> obj <span class="token operator">=</span> group<span class="token punctuation">.</span><span class="token function">toJSON</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 一个模型组转成json对象</span>
<span class="token keyword">var</span> obj <span class="token operator">=</span> mesh<span class="token punctuation">.</span><span class="token function">toJSON</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 一个模型网格转成json</span>
<span class="token keyword">var</span> JSONStr <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 将json对象转换成json字符串</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h4 id="使用-objectloader-加载-json"><a href="#使用-objectloader-加载-json" class="header-anchor">#</a> 使用 ObjectLoader 加载 JSON</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> loader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>ObjectLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
loader<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span><span class="token string">&quot;./model.json&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">group</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  group<span class="token punctuation">.</span>position<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  scene<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>group<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h4 id="导入-gltf"><a href="#导入-gltf" class="header-anchor">#</a> 导入 GLTF</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 引入threejs官方的加载器</span>
<span class="token comment">// https://github.com/mrdoob/three.js/edit/dev/examples/jsm/loaders/GLTFLoader.js</span>
<span class="token keyword">const</span> loader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">window<span class="token punctuation">.</span>GLTFLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
loader<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span><span class="token string">&quot;./3d/tol/scene.gltf&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">gltf</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  scene<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>gltf<span class="token punctuation">.</span>scene<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h3 id="动画"><a href="#动画" class="header-anchor">#</a> 动画</h3> <h4 id="骨骼动画"><a href="#骨骼动画" class="header-anchor">#</a> 骨骼动画</h4> <h4 id="变形动画"><a href="#变形动画" class="header-anchor">#</a> 变形动画</h4></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2023/01/30 02:37</span></div></footer> <div class="page-nav"><p class="inner"><!----> <span class="next"><a href="/my-articles/pages/studyNote/尚硅谷React.html">
        尚硅谷React
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/my-articles/assets/js/app.6e1f7d07.js" defer></script><script src="/my-articles/assets/js/2.2fae7045.js" defer></script><script src="/my-articles/assets/js/51.8de6d8ea.js" defer></script>
  </body>
</html>
