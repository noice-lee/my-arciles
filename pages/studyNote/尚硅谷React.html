<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>尚硅谷React全家桶(天禹老师主讲) | 不加冰</title>
    <meta name="generator" content="VuePress 1.9.7">
    
    <meta name="description" content="">
    
    <link rel="preload" href="/my-articles/assets/css/0.styles.82ef5590.css" as="style"><link rel="preload" href="/my-articles/assets/js/app.bb82ac71.js" as="script"><link rel="preload" href="/my-articles/assets/js/2.9cb2f34b.js" as="script"><link rel="preload" href="/my-articles/assets/js/34.23ec2839.js" as="script"><link rel="prefetch" href="/my-articles/assets/js/10.84e272b4.js"><link rel="prefetch" href="/my-articles/assets/js/11.ca4f6ee4.js"><link rel="prefetch" href="/my-articles/assets/js/12.085cc122.js"><link rel="prefetch" href="/my-articles/assets/js/13.bc3a0942.js"><link rel="prefetch" href="/my-articles/assets/js/14.c8e891d6.js"><link rel="prefetch" href="/my-articles/assets/js/15.4f18dcb7.js"><link rel="prefetch" href="/my-articles/assets/js/16.8f2bb59a.js"><link rel="prefetch" href="/my-articles/assets/js/17.a781bd7d.js"><link rel="prefetch" href="/my-articles/assets/js/18.c1c2e043.js"><link rel="prefetch" href="/my-articles/assets/js/19.081a4792.js"><link rel="prefetch" href="/my-articles/assets/js/20.23f38066.js"><link rel="prefetch" href="/my-articles/assets/js/21.68dff99a.js"><link rel="prefetch" href="/my-articles/assets/js/22.b857f02f.js"><link rel="prefetch" href="/my-articles/assets/js/23.f9373483.js"><link rel="prefetch" href="/my-articles/assets/js/24.f6cdd991.js"><link rel="prefetch" href="/my-articles/assets/js/25.a9aa1f89.js"><link rel="prefetch" href="/my-articles/assets/js/26.7e6e1481.js"><link rel="prefetch" href="/my-articles/assets/js/27.4dc88887.js"><link rel="prefetch" href="/my-articles/assets/js/28.906dbe17.js"><link rel="prefetch" href="/my-articles/assets/js/29.1700403d.js"><link rel="prefetch" href="/my-articles/assets/js/3.5dcd40f5.js"><link rel="prefetch" href="/my-articles/assets/js/30.bc31f5a3.js"><link rel="prefetch" href="/my-articles/assets/js/31.c5eea0c0.js"><link rel="prefetch" href="/my-articles/assets/js/32.d3c45add.js"><link rel="prefetch" href="/my-articles/assets/js/33.bb165630.js"><link rel="prefetch" href="/my-articles/assets/js/35.6c4fde00.js"><link rel="prefetch" href="/my-articles/assets/js/36.5536811c.js"><link rel="prefetch" href="/my-articles/assets/js/37.11c1042d.js"><link rel="prefetch" href="/my-articles/assets/js/38.4cc40180.js"><link rel="prefetch" href="/my-articles/assets/js/39.538a8f1c.js"><link rel="prefetch" href="/my-articles/assets/js/4.a226a210.js"><link rel="prefetch" href="/my-articles/assets/js/40.4445a6ce.js"><link rel="prefetch" href="/my-articles/assets/js/41.e3416c1c.js"><link rel="prefetch" href="/my-articles/assets/js/42.34ca91f5.js"><link rel="prefetch" href="/my-articles/assets/js/5.792e5208.js"><link rel="prefetch" href="/my-articles/assets/js/6.3902e76e.js"><link rel="prefetch" href="/my-articles/assets/js/7.ea050b32.js"><link rel="prefetch" href="/my-articles/assets/js/8.6c82b6f7.js"><link rel="prefetch" href="/my-articles/assets/js/9.3b6f6ab8.js">
    <link rel="stylesheet" href="/my-articles/assets/css/0.styles.82ef5590.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/my-articles/" class="home-link router-link-active"><img src="/my-articles/2022-03-24_115321.png" alt="不加冰" class="logo"> <span class="site-name can-hide">不加冰</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/my-articles/pages/notes/01-2022年6月记.html" class="nav-link">
  随心记
</a></div><div class="nav-item"><a href="/my-articles/pages/engineering/引入ESLint、Prettier、pre-commit.html" class="nav-link">
  前端工程化
</a></div><div class="nav-item"><a href="/my-articles/pages/data/队列结构.html" class="nav-link">
  数据结构
</a></div><div class="nav-item"><a href="/my-articles/pages/vue/插槽、组件.html" class="nav-link">
  Vue学习
</a></div><div class="nav-item"><a href="/my-articles/pages/uniapp/uCharts地图标点.html" class="nav-link">
  uniapp
</a></div><div class="nav-item"><a href="/my-articles/pages/leetcode/easy/001.两数之和.html" class="nav-link">
  力扣算法
</a></div><div class="nav-item"><a href="/my-articles/pages/studyNote/慕课网大前端.html" class="nav-link">
  学习笔记
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/my-articles/pages/notes/01-2022年6月记.html" class="nav-link">
  随心记
</a></div><div class="nav-item"><a href="/my-articles/pages/engineering/引入ESLint、Prettier、pre-commit.html" class="nav-link">
  前端工程化
</a></div><div class="nav-item"><a href="/my-articles/pages/data/队列结构.html" class="nav-link">
  数据结构
</a></div><div class="nav-item"><a href="/my-articles/pages/vue/插槽、组件.html" class="nav-link">
  Vue学习
</a></div><div class="nav-item"><a href="/my-articles/pages/uniapp/uCharts地图标点.html" class="nav-link">
  uniapp
</a></div><div class="nav-item"><a href="/my-articles/pages/leetcode/easy/001.两数之和.html" class="nav-link">
  力扣算法
</a></div><div class="nav-item"><a href="/my-articles/pages/studyNote/慕课网大前端.html" class="nav-link">
  学习笔记
</a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/my-articles/pages/studyNote/慕课网大前端.html" class="sidebar-link">慕课网大前端</a></li><li><a href="/my-articles/pages/studyNote/开课吧web高级.html" class="sidebar-link">开课吧web高级</a></li><li><a href="/my-articles/pages/studyNote/尚硅谷React.html" class="active sidebar-link">尚硅谷React</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/my-articles/pages/studyNote/尚硅谷React.html#jsx语法规则" class="sidebar-link">JSX语法规则</a></li><li class="sidebar-sub-header"><a href="/my-articles/pages/studyNote/尚硅谷React.html#箭头函数返回对象简写" class="sidebar-link">箭头函数返回对象简写</a></li><li class="sidebar-sub-header"><a href="/my-articles/pages/studyNote/尚硅谷React.html#js语句和js表达式区别" class="sidebar-link">js语句和js表达式区别</a></li><li class="sidebar-sub-header"><a href="/my-articles/pages/studyNote/尚硅谷React.html#类的基本知识-复习" class="sidebar-link">类的基本知识(复习)</a></li><li class="sidebar-sub-header"><a href="/my-articles/pages/studyNote/尚硅谷React.html#reactdom-render-后发生了什么" class="sidebar-link">ReactDOM.render()后发生了什么</a></li><li class="sidebar-sub-header"><a href="/my-articles/pages/studyNote/尚硅谷React.html#render中的this指向" class="sidebar-link">render中的this指向</a></li><li class="sidebar-sub-header"><a href="/my-articles/pages/studyNote/尚硅谷React.html#组件中的普通函数的this指向" class="sidebar-link">组件中的普通函数的this指向</a></li><li class="sidebar-sub-header"><a href="/my-articles/pages/studyNote/尚硅谷React.html#js数组reduce方法-统计" class="sidebar-link">js数组reduce方法-统计</a></li><li class="sidebar-sub-header"><a href="/my-articles/pages/studyNote/尚硅谷React.html#js克隆对象" class="sidebar-link">js克隆对象</a></li><li class="sidebar-sub-header"><a href="/my-articles/pages/studyNote/尚硅谷React.html#props类型和默认值" class="sidebar-link">props类型和默认值</a></li><li class="sidebar-sub-header"><a href="/my-articles/pages/studyNote/尚硅谷React.html#绑定ref" class="sidebar-link">绑定ref</a></li><li class="sidebar-sub-header"><a href="/my-articles/pages/studyNote/尚硅谷React.html#事件总结" class="sidebar-link">事件总结</a></li><li class="sidebar-sub-header"><a href="/my-articles/pages/studyNote/尚硅谷React.html#非受控组件" class="sidebar-link">非受控组件</a></li><li class="sidebar-sub-header"><a href="/my-articles/pages/studyNote/尚硅谷React.html#受控组件" class="sidebar-link">受控组件</a></li><li class="sidebar-sub-header"><a href="/my-articles/pages/studyNote/尚硅谷React.html#高阶函数概念" class="sidebar-link">高阶函数概念</a></li><li class="sidebar-sub-header"><a href="/my-articles/pages/studyNote/尚硅谷React.html#dataset实现onchange" class="sidebar-link">dataset实现onChange</a></li><li class="sidebar-sub-header"><a href="/my-articles/pages/studyNote/尚硅谷React.html#函数柯里化实现onchange" class="sidebar-link">函数柯里化实现onChange</a></li><li class="sidebar-sub-header"><a href="/my-articles/pages/studyNote/尚硅谷React.html#组件生命周期-旧" class="sidebar-link">组件生命周期（旧）</a></li><li class="sidebar-sub-header"><a href="/my-articles/pages/studyNote/尚硅谷React.html#组件生命周期-新" class="sidebar-link">组件生命周期（新）</a></li><li class="sidebar-sub-header"><a href="/my-articles/pages/studyNote/尚硅谷React.html#diff" class="sidebar-link">diff</a></li><li class="sidebar-sub-header"><a href="/my-articles/pages/studyNote/尚硅谷React.html#苹果桌面图标" class="sidebar-link">苹果桌面图标</a></li><li class="sidebar-sub-header"><a href="/my-articles/pages/studyNote/尚硅谷React.html#esmodule引入注意" class="sidebar-link">ESmodule引入注意</a></li><li class="sidebar-sub-header"><a href="/my-articles/pages/studyNote/尚硅谷React.html#配置开发请求代理" class="sidebar-link">配置开发请求代理</a></li><li class="sidebar-sub-header"><a href="/my-articles/pages/studyNote/尚硅谷React.html#对象连续解构" class="sidebar-link">对象连续解构</a></li><li class="sidebar-sub-header"><a href="/my-articles/pages/studyNote/尚硅谷React.html#路由-react-router-dom" class="sidebar-link">路由: react-router-dom</a></li><li class="sidebar-sub-header"><a href="/my-articles/pages/studyNote/尚硅谷React.html#状态管理redux" class="sidebar-link">状态管理Redux</a></li><li class="sidebar-sub-header"><a href="/my-articles/pages/studyNote/尚硅谷React.html#状态管理react-redux" class="sidebar-link">状态管理react-redux</a></li></ul></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="尚硅谷react全家桶-天禹老师主讲"><a href="#尚硅谷react全家桶-天禹老师主讲" class="header-anchor">#</a> 尚硅谷React全家桶(天禹老师主讲)</h1> <blockquote><p>视频跟敲代码地址: <a href="https://note.youdao.com/" target="_blank" rel="noopener noreferrer">码云<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></blockquote> <h2 id="jsx语法规则"><a href="#jsx语法规则" class="header-anchor">#</a> JSX语法规则</h2> <ol><li>定义虚拟DOM时，不可用引号包裹</li> <li>使用js<strong>表达式</strong>时，使用大括号包裹，如<code>&lt;span&gt;{ theData }&lt;/span&gt;</code></li> <li>样式类名书写时，需使用<code>className=&quot;&quot;</code>，而不是<code>class=&quot;&quot;</code></li> <li>内联样式书写时，需使用对象形式书写</li></ol> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token operator">&lt;</span>span style<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">'red'</span><span class="token punctuation">,</span> <span class="token literal-property property">fontSize</span><span class="token operator">:</span> <span class="token string">'10px'</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span> theData <span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ol start="4"><li>标签必须闭合</li> <li>只有一个根元素</li> <li>标签首字母
（1）若小写字母开头，则直接转换为html中同名元素，若html中无对应元素，则报错；
（2）若大写字母开头，认定为组件</li></ol> <h2 id="箭头函数返回对象简写"><a href="#箭头函数返回对象简写" class="header-anchor">#</a> 箭头函数返回对象简写</h2> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token function-variable function">func</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">a</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">// 简写为</span>
<span class="token keyword">const</span> <span class="token function-variable function">fun</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">a</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h2 id="js语句和js表达式区别"><a href="#js语句和js表达式区别" class="header-anchor">#</a> js语句和js表达式区别</h2> <ul><li><p>js语句
逻辑判断、循环等</p></li> <li><p>js表达式
可返回一个值</p></li></ul> <h2 id="类的基本知识-复习"><a href="#类的基本知识-复习" class="header-anchor">#</a> 类的基本知识(复习)</h2> <ul><li>构造器<code>constructor</code>中的this指向后续创建的实例</li> <li>创建的一般的方法/变量，直接成为实例的方法/变量</li> <li>使用static等关键字声明的方法/变量，放到实例的原型对象上<div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">Home</span> <span class="token punctuation">{</span>
  <span class="token comment">// a会放到后续创建的实例上</span>
  a <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token comment">// b会放到类上</span>
  <span class="token keyword">static</span> b <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div></li></ul> <h2 id="reactdom-render-后发生了什么"><a href="#reactdom-render-后发生了什么" class="header-anchor">#</a> ReactDOM.render()后发生了什么</h2> <p>执行<code>ReactDOM.render(&lt;MyComponent/&gt;, document.getElementById('app'))</code>之后发生了什么</p> <ol><li>React解析组件标签，找到<code>MyComponent</code>组件</li> <li>如果发现是使用函数定义的，执行该函数</li> <li>如果发现是使用类定义的，new出来这个实例，并通过该实例调用原型上的<code>render</code>方法</li> <li>将返回的虚拟DOM转换为真实DOM，渲染到页面上</li></ol> <h2 id="render中的this指向"><a href="#render中的this指向" class="header-anchor">#</a> render中的this指向</h2> <p>this指向MyComponent组件实例对象</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">class</span> <span class="token class-name">MyComponent</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>

  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">/**
     * this指向后续new MyComponent()创建出来的对象（这个React会帮执行）
     * -&gt;
     * this指向MyComponent的实例对象
     * -&gt;
     * this指向MyComponent组件实例对象
     */</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>   <span class="token comment">// MyComponent的实例对象</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token operator">&lt;</span>h2<span class="token operator">&gt;</span>我是类定义的组件<span class="token operator">&lt;</span><span class="token operator">/</span>h2<span class="token operator">&gt;</span>
    <span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

ReactDOM<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>MyComponent <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'app'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><h2 id="组件中的普通函数的this指向"><a href="#组件中的普通函数的this指向" class="header-anchor">#</a> 组件中的普通函数的this指向</h2> <p>默认情况下，谁调用该函数就指谁。
需注意，直接在给JSX语法中添加<code>onClick</code>事件回调时，回调函数执行时的this是指向<strong>undefined</strong>的。
是因为由于该事件回调是直接赋值给<code>onClick</code>直接执行的，只有由组件实例调用该函数时才会指向实例本身，而类的写法里面开启了局部严格模式，babel也开启了严格模式(React会经过babel编译)，所以指向undefined。</p> <h2 id="js数组reduce方法-统计"><a href="#js数组reduce方法-统计" class="header-anchor">#</a> js数组reduce方法-统计</h2> <p>接收一个函数，遍历数组，函数的第一个参数为上一个值，函数的第二个参数为当前值，遍历结束后返回最后返回的值
接收第二个参数，统计的初始值</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 计算和</span>
<span class="token keyword">const</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> sum <span class="token operator">=</span> arr<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">preVal<span class="token punctuation">,</span> curVal</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> preVal <span class="token operator">+</span> curVal<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>sum<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 16</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h2 id="js克隆对象"><a href="#js克隆对象" class="header-anchor">#</a> js克隆对象</h2> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">a</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token literal-property property">b</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> obj2 <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token operator">...</span>obj <span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>在React传递Props时，使用的语法看似是对象解构，其实不是，是React+Babel的语法，才可以这么写</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>ReactDOM<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>Person <span class="token punctuation">{</span> <span class="token operator">...</span>p1 <span class="token punctuation">}</span><span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'app1'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="props类型和默认值"><a href="#props类型和默认值" class="header-anchor">#</a> props类型和默认值</h2> <ol><li>完整写法</li></ol> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> PropTypes <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>
<span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
<span class="token punctuation">}</span>

<span class="token comment">// 类型</span>
Person<span class="token punctuation">.</span>propTypes <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> PropTypes<span class="token punctuation">.</span>string<span class="token punctuation">.</span>isRequired<span class="token punctuation">,</span>
    <span class="token literal-property property">sex</span><span class="token operator">:</span> Proptypes<span class="token punctuation">.</span>func<span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token comment">// 默认值</span>
Person<span class="token punctuation">.</span>defaultProps <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token string">'未知'</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><ol><li>简写</li></ol> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>

    <span class="token keyword">static</span> defaultProps <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token string">'未知'</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">static</span> propTypes <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">name</span><span class="token operator">:</span> PropTypes<span class="token punctuation">.</span>string<span class="token punctuation">.</span>isRequired<span class="token punctuation">,</span>
        <span class="token literal-property property">sex</span><span class="token operator">:</span> Proptypes<span class="token punctuation">.</span>func<span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><hr> <h2 id="绑定ref"><a href="#绑定ref" class="header-anchor">#</a> 绑定ref</h2> <ol><li>绑定string的ref</li></ol> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>

    <span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 通过this.refs来访问</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>refs<span class="token punctuation">.</span>r1<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span>
            <span class="token operator">&lt;</span>div ref<span class="token operator">=</span><span class="token string">&quot;r1&quot;</span> onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>show<span class="token punctuation">}</span><span class="token operator">&gt;</span>refs<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
        <span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><ol start="2"><li>通过回调绑定ref</li></ol> <ul><li>内联回调</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>

    <span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 直接通过this访问</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>r1<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span>
            <span class="token punctuation">{</span><span class="token comment">/* 这是JSX注释的写法 */</span><span class="token punctuation">}</span>
            <span class="token punctuation">{</span><span class="token comment">/* 
                这里ref内是个回调，接收一个参数，就是节点本身
                执行时给实例添加一个r1变量，保存节点本身
                首次执行render函数时执行一次
                setState时执行两次，第一次参数是null，第二次参数是节点本身
            */</span><span class="token punctuation">}</span>
            <span class="token operator">&lt;</span>div ref<span class="token operator">=</span><span class="token punctuation">{</span><span class="token parameter">c</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>r1 <span class="token operator">=</span> c<span class="token punctuation">}</span><span class="token punctuation">}</span> onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>show<span class="token punctuation">}</span><span class="token operator">&gt;</span>refs<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
        <span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><ul><li>类的函数</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>

    <span class="token function">bindRef</span><span class="token punctuation">(</span><span class="token parameter">ele</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>r1 <span class="token operator">=</span> ele
    <span class="token punctuation">}</span>
    
    <span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 直接通过this访问</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>r1<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span>
            <span class="token operator">&lt;</span>div ref<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>bindRef<span class="token punctuation">}</span> onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>show<span class="token punctuation">}</span><span class="token operator">&gt;</span>refs<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
        <span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><ol start="3"><li>通过<code>createRef</code>绑定ref</li></ol> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
    <span class="token comment">// 每次执行React.createRef都可绑定一个ref</span>
    bindRef <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">createRef</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token comment">// 若创建多个ref，再来一个就行</span>
    bindRef2 <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">createRef</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 直接通过this访问</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>r1<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span>
            <span class="token operator">&lt;</span>div ref<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>bindRef<span class="token punctuation">}</span> onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>show<span class="token punctuation">}</span><span class="token operator">&gt;</span>refs<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
        <span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><hr> <h2 id="事件总结"><a href="#事件总结" class="header-anchor">#</a> 事件总结</h2> <ol><li>通过<code>onXxxx</code>来绑定事件函数，注意大小写</li> <li>React使用的不是原生DOM事件，而是经过封装的 ———— 为了更好的兼容性</li> <li>React使用的是事件委托（委托给组件最外层的元素）———— 为了更好的性能</li> <li>回调函数中接收一个参数，就是绑定事件的元素，如：</li></ol> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>

    <span class="token function-variable function">blur</span> <span class="token operator">=</span> <span class="token parameter">event</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token comment">// event类似原生的event</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// event.target就是元素本身</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span>target<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// event.target.value可以获取输入框的值</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span>target<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span>
            <span class="token operator">&lt;</span>input onBlur<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>blur<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
        <span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><h2 id="非受控组件"><a href="#非受控组件" class="header-anchor">#</a> 非受控组件</h2> <p>页面上的数据现用现取，提交表单时才去获取输入框的值</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">Login</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>

    <span class="token function-variable function">handleSubmit</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        e<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 提交时才去读取输入框的值</span>
        <span class="token function">alert</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>uname<span class="token punctuation">.</span>value <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>upwd<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span>
            <span class="token operator">&lt;</span>form onSubmit<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>handleSubmit<span class="token punctuation">}</span><span class="token operator">&gt;</span>
                用户名：<span class="token operator">&lt;</span>input ref<span class="token operator">=</span><span class="token punctuation">{</span><span class="token parameter">c</span> <span class="token operator">=&gt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>uname <span class="token operator">=</span> c<span class="token punctuation">}</span> type<span class="token operator">=</span><span class="token string">&quot;text&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
                密码：<span class="token operator">&lt;</span>input ref<span class="token operator">=</span><span class="token punctuation">{</span><span class="token parameter">c</span> <span class="token operator">=&gt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>upwd <span class="token operator">=</span> c<span class="token punctuation">}</span> type<span class="token operator">=</span><span class="token string">&quot;text&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>button<span class="token operator">&gt;</span>登录<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token operator">/</span>form<span class="token operator">&gt;</span>
        <span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><h2 id="受控组件"><a href="#受控组件" class="header-anchor">#</a> 受控组件</h2> <p>页面上的数据存到<code>state</code>中，在输入框改变的<code>onChange</code>事件中修改<code>state</code>的值，用的时候从<code>state</code>中取</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">Login</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>

    state <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">uname</span><span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span>
        <span class="token literal-property property">upwd</span><span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
    
    <span class="token function-variable function">unameChange</span> <span class="token operator">=</span> <span class="token parameter">e</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            <span class="token literal-property property">uname</span><span class="token operator">:</span> e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>value<span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token function-variable function">upwdChange</span> <span class="token operator">=</span> <span class="token parameter">e</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            <span class="token literal-property property">upwd</span><span class="token operator">:</span> e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>value<span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token function-variable function">handleSubmit</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        e<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">alert</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">账号:</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>uname<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">，密码:</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>upwd<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span>
            <span class="token operator">&lt;</span>form onSubmit<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>handleSubmit<span class="token punctuation">}</span><span class="token operator">&gt;</span>
                用户名：<span class="token operator">&lt;</span>input onChange<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>unameChange<span class="token punctuation">}</span> type<span class="token operator">=</span><span class="token string">&quot;text&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
                密码：<span class="token operator">&lt;</span>input onChange<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>upwdChange<span class="token punctuation">}</span> type<span class="token operator">=</span><span class="token string">&quot;text&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>button<span class="token operator">&gt;</span>登录<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token operator">/</span>form<span class="token operator">&gt;</span>
        <span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br></div></div><h2 id="高阶函数概念"><a href="#高阶函数概念" class="header-anchor">#</a> 高阶函数概念</h2> <ol><li>如果一个函数接收参数中包含一个函数，则可以称之为高阶函数</li> <li>如果一个函数的返回值是一个函数，则可以称之为高阶函数</li></ol> <h2 id="dataset实现onchange"><a href="#dataset实现onchange" class="header-anchor">#</a> dataset实现onChange</h2> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">Login</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Compontent</span> <span class="token punctuation">{</span>
    
    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">rerturn</span> <span class="token punctuation">(</span>
            <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>input onChange<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>myChange<span class="token punctuation">}</span> data<span class="token operator">-</span>name<span class="token operator">=</span><span class="token string">&quot;uname&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>input onChange<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>myChange<span class="token punctuation">}</span> data<span class="token operator">-</span>name<span class="token operator">=</span><span class="token string">&quot;upwd&quot;</span><span class="token operator">/</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
        <span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    
    <span class="token function-variable function">myChange</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            <span class="token comment">// 获取元素上绑定的data-name的值</span>
            <span class="token punctuation">[</span>e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>dataset<span class="token punctuation">.</span>name<span class="token punctuation">]</span><span class="token operator">:</span> e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>value
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><h2 id="函数柯里化实现onchange"><a href="#函数柯里化实现onchange" class="header-anchor">#</a> 函数柯里化实现onChange</h2> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">Login</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Compontent</span> <span class="token punctuation">{</span>
    
    change <span class="token operator">=</span> key <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token function">myChange</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token function-variable function">myChange</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">key<span class="token punctuation">,</span> ele</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            <span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token operator">:</span> ele<span class="token punctuation">.</span>target<span class="token punctuation">.</span>value<span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">rerturn</span> <span class="token punctuation">(</span>
            <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
                <span class="token punctuation">{</span><span class="token comment">/* 两种不同写法 */</span><span class="token punctuation">}</span>
                <span class="token operator">&lt;</span>input onChange<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">change</span><span class="token punctuation">(</span><span class="token string">'uname'</span><span class="token punctuation">)</span><span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>input onChange<span class="token operator">=</span><span class="token punctuation">{</span><span class="token parameter">e</span> <span class="token operator">=&gt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">myChange</span><span class="token punctuation">(</span><span class="token string">'upwd'</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
        <span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><h2 id="组件生命周期-旧"><a href="#组件生命周期-旧" class="header-anchor">#</a> 组件生命周期（旧）</h2> <h4 id="图示"><a href="#图示" class="header-anchor">#</a> 图示</h4> <p><img src="https://vkceyugu.cdn.bspapp.com/VKCEYUGU-ce1af42d-76fa-4a5c-9768-cebbc1aa816f/11e0cdba-2c71-4e82-b131-5ada8271fc46.png" alt="生命周期-旧"></p> <h4 id="组件挂载"><a href="#组件挂载" class="header-anchor">#</a> 组件挂载</h4> <ol><li><code>constructor</code></li> <li><code>componentWillMount</code></li> <li><code>render</code></li> <li><code>componentDidMount</code> --- 常用</li></ol> <h4 id="组件更新"><a href="#组件更新" class="header-anchor">#</a> 组件更新</h4> <ol><li><code>shuldComponentUpdate</code></li> <li><code>componentWillUpdate</code></li> <li><code>render</code> --- 常用</li> <li><code>componentDidUpdate</code></li></ol> <h4 id="卸载组件"><a href="#卸载组件" class="header-anchor">#</a> 卸载组件</h4> <ol><li><code>componentWillUnmount</code> --- 常用</li></ol> <h2 id="组件生命周期-新"><a href="#组件生命周期-新" class="header-anchor">#</a> 组件生命周期（新）</h2> <h4 id="组件挂载-2"><a href="#组件挂载-2" class="header-anchor">#</a> 组件挂载</h4> <ol><li><code>constructor</code></li> <li><code>getDerivedStateFromProps</code></li> <li><code>render</code></li> <li><code>getSnapshotBeforeUpdate</code></li> <li><code>componentDidMount</code> --- 常用</li></ol> <h4 id="组件更新-2"><a href="#组件更新-2" class="header-anchor">#</a> 组件更新</h4> <ol><li><code>getDerivedStateFromProps</code></li> <li><code>shuldComponentUpdate</code></li> <li><code>render</code> --- 常用</li> <li><code>componentDidUpdate</code></li></ol> <h4 id="卸载组件-2"><a href="#卸载组件-2" class="header-anchor">#</a> 卸载组件</h4> <ol><li><code>componentWillUnmount</code> --- 常用</li></ol> <p><img src="https://vkceyugu.cdn.bspapp.com/VKCEYUGU-ce1af42d-76fa-4a5c-9768-cebbc1aa816f/30498f20-74bd-4569-9640-1b0bf001e3c5.png" alt="生命周期-新"></p> <hr> <h2 id="diff"><a href="#diff" class="header-anchor">#</a> diff</h2> <h4 id="算法逻辑"><a href="#算法逻辑" class="header-anchor">#</a> 算法逻辑</h4> <div class="language- line-numbers-mode"><pre class="language-text"><code>数据更新时，找同级下有无相同的key
    有相同key则判断对应数据是否相同
        如果相同则复用
        如果不同则直接创建新DOM替换
    没相同key有则直接创建新DOM
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h4 id="使用index做key可能有问题"><a href="#使用index做key可能有问题" class="header-anchor">#</a> 使用index做key可能有问题</h4> <ol><li>如果对数据的非末尾的位置添加或删除，则会导致无法复用DOM，更新效率变低</li> <li>如果循环中包含输入类的元素且对数据非末尾位置添加或删除，则会导致输入类的元素的值出现异常</li></ol> <hr> <h2 id="苹果桌面图标"><a href="#苹果桌面图标" class="header-anchor">#</a> 苹果桌面图标</h2> <p><code>&lt;link rel=&quot;apple-touch-icon&quot;href=&quot;/qz.png&quot;/&gt;</code></p> <h2 id="esmodule引入注意"><a href="#esmodule引入注意" class="header-anchor">#</a> ESmodule引入注意</h2> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 引入的Component不是解构赋值，而是在React中使用了两种导出方式</span>
<span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> Component <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'React'</span><span class="token punctuation">;</span>

<span class="token comment">// 例如</span>
<span class="token comment">// React中</span>
<span class="token keyword">export</span> Class Component <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">const</span> React <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
React<span class="token punctuation">.</span>Component <span class="token operator">=</span> Component
<span class="token keyword">export</span> <span class="token keyword">default</span> React<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h2 id="配置开发请求代理"><a href="#配置开发请求代理" class="header-anchor">#</a> 配置开发请求代理</h2> <h4 id="package-json中配置"><a href="#package-json中配置" class="header-anchor">#</a> package.json中配置</h4> <ol><li>添加proxy，proxy后代表的是后端的地址，指后端接口运行在localhost的3000端口下</li></ol> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;proxy&quot;</span><span class="token operator">:</span> <span class="token string">&quot;http://localhost:3000&quot;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ol start="2"><li>当前端react项目运行在8080端口下时，向前端项目开启的端口发送请求，即会代理到配置的后端接口</li></ol> <div class="language-js line-numbers-mode"><pre class="language-js"><code>axios<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'http://localhost:8080/user'</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><blockquote><p>发送请求时，先去本地的public目录下寻找，如果public目录下没有，将会转发到proxy配置的地址上</p></blockquote> <h4 id="配置文件中配置"><a href="#配置文件中配置" class="header-anchor">#</a> 配置文件中配置</h4> <p>在<code>/src/setupProxy.js</code>中配置</p> <h2 id="对象连续解构"><a href="#对象连续解构" class="header-anchor">#</a> 对象连续解构</h2> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> a <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">b</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">c</span><span class="token operator">:</span> <span class="token number">1</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 连续解构 + 重命名</span>
<span class="token comment">// 获取不到 b</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> <span class="token literal-property property">b</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">c</span><span class="token operator">:</span>d <span class="token punctuation">}</span> <span class="token punctuation">}</span> <span class="token operator">=</span> a
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span> <span class="token comment">// 1</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h2 id="路由-react-router-dom"><a href="#路由-react-router-dom" class="header-anchor">#</a> 路由: react-router-dom</h2> <h4 id="使用要求"><a href="#使用要求" class="header-anchor">#</a> 使用要求</h4> <ul><li>所有的路由需放到一个路由根标签(<code>BrowserRouter</code>或<code>HashRouter</code>)下，才可对应渲染</li> <li>哈希路由或者历史路由</li> <li>推荐放到入口文件的app外层</li></ul> <h4 id="路由组件和普通组件的区别"><a href="#路由组件和普通组件的区别" class="header-anchor">#</a> 路由组件和普通组件的区别</h4> <ol><li>使用方式不同</li></ol> <ul><li>普通组件直接自己调用</li> <li>路由组交由Route来调用</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 普通组件</span>
<span class="token operator">&lt;</span>Home <span class="token operator">/</span><span class="token operator">&gt;</span>

<span class="token comment">// 路由组件</span>
<span class="token operator">&lt;</span>Route path<span class="token operator">=</span><span class="token string">'/home'</span> component<span class="token operator">=</span><span class="token punctuation">{</span>Home<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><ol start="2"><li>存放位置不同</li></ol> <ul><li>普通组件放到<code>/src/components</code>中</li> <li>路由组件放到<code>/src/pages</code>中</li></ul> <ol start="3"><li>接收的props不同</li></ol> <ul><li>普通组件默认没有参数</li> <li>路由组件默认有参数 <code>history</code> <code>route</code> <code>match</code></li></ul> <h4 id="link组件"><a href="#link组件" class="header-anchor">#</a> Link组件</h4> <ul><li>to属性代表对应的路由</li> <li>编译成a标签</li></ul> <h4 id="navlink组件"><a href="#navlink组件" class="header-anchor">#</a> NavLink组件</h4> <ul><li>Link的升级版，实现路由激活项的高亮</li> <li>通过给Link的激活项添加一个<code>active</code>类名，类名可自定义</li> <li>通过this.props.children可获取标签体内容（两标签之间的内容）</li></ul> <h4 id="switch组件"><a href="#switch组件" class="header-anchor">#</a> Switch组件</h4> <p>只有使用switch包裹时，当路由匹配到一个组件时才不会接着向下匹配其他router</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token operator">&lt;</span>Switch<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>Route path<span class="token operator">=</span><span class="token string">'/home'</span> component<span class="token operator">=</span><span class="token punctuation">{</span>Home<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>Route path<span class="token operator">=</span><span class="token string">'/about'</span> component<span class="token operator">=</span><span class="token punctuation">{</span>About<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
  <span class="token punctuation">{</span><span class="token comment">/* 这样就不会往下查找匹配 */</span><span class="token punctuation">}</span>
  <span class="token operator">&lt;</span>Route path<span class="token operator">=</span><span class="token string">'/about'</span> component<span class="token operator">=</span><span class="token punctuation">{</span>Axi<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>Switch<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h4 id="多级路径时css样式丢失"><a href="#多级路径时css样式丢失" class="header-anchor">#</a> 多级路径时css样式丢失</h4> <h5 id="出现原因"><a href="#出现原因" class="header-anchor">#</a> 出现原因</h5> <p>是因为如果在index.html中使用相对路径引入样式，并且是多级路径时，浏览器会认定最后一级路径为index.html的相对路径，所以会出现样式路径上多了些前缀</p> <h5 id="解决方法-三种"><a href="#解决方法-三种" class="header-anchor">#</a> 解决方法（三种）</h5> <ul><li>使用绝对路径</li> <li>在react脚手架创建的项目可以使用样式文件前加webpack的基础路径变量来控制<code>%PUBLIC_URL%</code></li> <li>使用哈希模式的路由</li></ul> <h4 id="模糊匹配-精准匹配"><a href="#模糊匹配-精准匹配" class="header-anchor">#</a> 模糊匹配？精准匹配</h4> <ul><li>默认是模糊匹配，需要给Route组件传<code>exact</code>来开启精准匹配</li> <li>模糊匹配是Route的路径与Link中的路径的开头匹配就可以</li> <li>开启精准匹配会造成识别不到二级路由</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token punctuation">{</span><span class="token comment">/* 开启精准匹配 */</span><span class="token punctuation">}</span>
<span class="token operator">&lt;</span>Route exact path<span class="token operator">=</span><span class="token string">'/home'</span> component<span class="token operator">=</span><span class="token punctuation">{</span>Home<span class="token punctuation">}</span><span class="token operator">/</span><span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h4 id="重定向"><a href="#重定向" class="header-anchor">#</a> 重定向</h4> <p>当一个switch中所有的路由都匹配不上时，可添加一个<code>Redirect</code>，来指定匹配不到时的路径</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token operator">&lt;</span>Switch<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>Route path<span class="token operator">=</span><span class="token string">'/home'</span> component<span class="token operator">=</span><span class="token punctuation">{</span>Home<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>Route path<span class="token operator">=</span><span class="token string">'/about'</span> component<span class="token operator">=</span><span class="token punctuation">{</span>About<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
  <span class="token punctuation">{</span><span class="token comment">/* 默认显示home */</span><span class="token punctuation">}</span>
  <span class="token operator">&lt;</span>Redirect to<span class="token operator">=</span><span class="token string">'/home'</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>Switch<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><hr> <h4 id="嵌套路由"><a href="#嵌套路由" class="header-anchor">#</a> 嵌套路由</h4> <h5 id="实现方式"><a href="#实现方式" class="header-anchor">#</a> 实现方式</h5> <p>在路由组件中继续定义路由，子路由里面需要写上<strong>父路由的路径作为前缀</strong>，否则会导致匹配不到</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token punctuation">{</span><span class="token comment">/* home组件中继续定义路由组件 */</span><span class="token punctuation">}</span>
<span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>MyNavLink to<span class="token operator">=</span><span class="token string">&quot;/home/news&quot;</span><span class="token operator">&gt;</span>新闻<span class="token operator">&lt;</span><span class="token operator">/</span>MyNavLink<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>MyNavLink to<span class="token operator">=</span><span class="token string">&quot;/home/message&quot;</span><span class="token operator">&gt;</span>信息<span class="token operator">&lt;</span><span class="token operator">/</span>MyNavLink<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>Switch<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>Route path<span class="token operator">=</span><span class="token string">&quot;/home/news&quot;</span> component<span class="token operator">=</span><span class="token punctuation">{</span>News<span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>Route<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>Route path<span class="token operator">=</span><span class="token string">&quot;/home/message&quot;</span> component<span class="token operator">=</span><span class="token punctuation">{</span>Message<span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>Route<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>Redirect to<span class="token operator">=</span><span class="token string">&quot;/home/news&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>Redirect<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>Switch<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h5 id="匹配流程"><a href="#匹配流程" class="header-anchor">#</a> 匹配流程</h5> <ol><li>当跳转到<code>/home/news</code>时，先去一级路由匹配，根据模糊匹配匹配到<code>/home</code></li> <li>然后渲染<code>Home</code>组件，然后去二级路由里面进行匹配，再匹配到<code>/home/news</code>进行渲染</li></ol> <h4 id="路由传参"><a href="#路由传参" class="header-anchor">#</a> 路由传参</h4> <p>state传参会在历史/哈希模式直接打开地址、哈希模式刷新页面时丢失数据，其他传参都不会丢失数据</p> <h5 id="传递params"><a href="#传递params" class="header-anchor">#</a> 传递params</h5> <ul><li>编写路由链接时以连续斜杠的方式携带参数</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token operator">&lt;</span>Link to<span class="token operator">=</span><span class="token string">&quot;/home/message/detail/1&quot;</span><span class="token operator">&gt;</span>ms1<span class="token operator">&lt;</span><span class="token operator">/</span>Link<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li>声明路由时定义接受的key</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token operator">&lt;</span>Route path<span class="token operator">=</span><span class="token punctuation">{</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">/home/message/detail/:id</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">}</span> component<span class="token operator">=</span><span class="token punctuation">{</span>Detail<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li>子路由中通过props.match.params接受参数</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token punctuation">{</span> id <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>match<span class="token punctuation">.</span>params<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h5 id="传递search"><a href="#传递search" class="header-anchor">#</a> 传递search</h5> <ul><li>编写路由链接时以查询字符串的形式传递参数</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token operator">&lt;</span>Link to<span class="token operator">=</span><span class="token string">&quot;/home/message/detail?id=3&quot;</span><span class="token operator">&gt;</span>ms3<span class="token operator">&lt;</span><span class="token operator">/</span>Link<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li>正常声明路由</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token operator">&lt;</span>Route path<span class="token operator">=</span><span class="token string">&quot;/home/message/detail&quot;</span> component<span class="token operator">=</span><span class="token punctuation">{</span>Detail<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li>子路由中通过props.location.search接收，接受到是未处理的查询参数，需手动处理，可通过querystring插件的方法来处理</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> qs <span class="token keyword">from</span> <span class="token string">'querystring'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token punctuation">{</span> id <span class="token punctuation">}</span> <span class="token operator">=</span> qs<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>location<span class="token punctuation">.</span>search<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h5 id="传递state"><a href="#传递state" class="header-anchor">#</a> 传递state</h5> <ul><li>编写路由链接时使用对象形式传递</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token operator">&lt;</span>Link to<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">'/home/message/detail'</span><span class="token punctuation">,</span> <span class="token literal-property property">state</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>ms5<span class="token operator">&lt;</span><span class="token operator">/</span>Link<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li>正常声明路由</li> <li>子路由中通过props.location.state接收参数</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token punctuation">{</span> id <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>location<span class="token punctuation">.</span>state <span class="token operator">||</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><hr> <h4 id="开启replace模式"><a href="#开启replace模式" class="header-anchor">#</a> 开启replace模式</h4> <p>开启后跳转时会进行替换，不保留历史记录</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token operator">&lt;</span>Link replace to<span class="token operator">=</span><span class="token string">&quot;/news&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="编程式导航"><a href="#编程式导航" class="header-anchor">#</a> 编程式导航</h4> <h5 id="通过路由的history对象进行跳转"><a href="#通过路由的history对象进行跳转" class="header-anchor">#</a> 通过路由的history对象进行跳转</h5> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>history<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">'/home?id=1'</span><span class="token punctuation">,</span> state对象<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>history<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">'/home/1/2'</span><span class="token punctuation">,</span> state对象<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>history<span class="token punctuation">.</span><span class="token function">go</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// 正数前进，负数后退</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>history<span class="token punctuation">.</span><span class="token function">goBack</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>history<span class="token punctuation">.</span><span class="token function">goForward</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h4 id="withrouter使用"><a href="#withrouter使用" class="header-anchor">#</a> withRouter使用</h4> <p>可解决在一般组件中不可使用路由的方法的问题，只需在定义一般组件时，在导出的组件外层使用<code>withRouter</code>函数包裹即可</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> withRouter <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react-router-dom'</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Home</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">withRouter</span><span class="token punctuation">(</span>Home<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h4 id="broswerrouter和hashrouter区别"><a href="#broswerrouter和hashrouter区别" class="header-anchor">#</a> BroswerRouter和HashRouter区别</h4> <ol><li>底层原理不同</li></ol> <ul><li>历史模式以浏览器的history API实现</li> <li>哈希模式以地址的哈希值（锚点）实现</li></ul> <ol start="2"><li>表现形式不同</li></ol> <ul><li>历史模式是 localhost:8080/home</li> <li>哈希模式是 localhost:8080/#/home</li></ul> <ol start="3"><li>页面刷新后的路由传参数据丢失不同</li></ol> <ul><li>历史模式刷新后所有传参都不会丢</li> <li>哈希模式刷新后state数据会丢，其他的不会丢</li></ul> <hr> <h2 id="状态管理redux"><a href="#状态管理redux" class="header-anchor">#</a> 状态管理Redux</h2> <h4 id="原理图"><a href="#原理图" class="header-anchor">#</a> 原理图</h4> <p><img src="https://vkceyugu.cdn.bspapp.com/VKCEYUGU-ce1af42d-76fa-4a5c-9768-cebbc1aa816f/df60cad8-e776-4f18-b5d1-a2fecb2a63f0.png" alt="redux原理图"></p> <h4 id="基础实现"><a href="#基础实现" class="header-anchor">#</a> 基础实现</h4> <ol><li>定义reducer</li></ol> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// /src/store/count_reducer.js</span>
<span class="token keyword">const</span> defaultCount <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">countReducer</span> <span class="token punctuation">(</span><span class="token parameter">prevousState <span class="token operator">=</span> defaultCount<span class="token punctuation">,</span> action</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> type<span class="token punctuation">,</span> data<span class="token punctuation">}</span> <span class="token operator">=</span> action<span class="token punctuation">;</span>
  <span class="token keyword">switch</span> <span class="token punctuation">(</span>type<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">case</span> <span class="token string">'increment'</span><span class="token operator">:</span>
      <span class="token keyword">return</span> prevousState <span class="token operator">+</span> data <span class="token operator">*</span> <span class="token number">1</span>

    <span class="token keyword">case</span> <span class="token string">'decrement'</span><span class="token operator">:</span>
      <span class="token keyword">return</span> prevousState <span class="token operator">-</span> data <span class="token operator">*</span> <span class="token number">1</span>
    
    <span class="token keyword">default</span><span class="token operator">:</span>
      <span class="token keyword">return</span> prevousState<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><ol start="2"><li>定义store</li></ol> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// /src/redux/sotre.js</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> createStore<span class="token punctuation">,</span> applyMiddleware <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'redux'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> countReducer <span class="token keyword">from</span> <span class="token string">'./count_reducer'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> thunk <span class="token keyword">from</span> <span class="token string">'redux-thunk'</span><span class="token punctuation">;</span>

<span class="token comment">// 只支持同步</span>
<span class="token comment">// export default createStore(countReducer);</span>
<span class="token comment">// 可支持异步</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">createStore</span><span class="token punctuation">(</span>countReducer<span class="token punctuation">,</span> <span class="token function">applyMiddleware</span><span class="token punctuation">(</span>thunk<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><ol start="3"><li>定义action</li></ol> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// /src/store/count_action.js</span>
<span class="token comment">// 同步是直接返回一个普通对象，交由reducer处理</span>
<span class="token comment">// 异步是返回一个函数，直接由store处理，在函数中可添加逻辑</span>

<span class="token comment">// 同步action</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">createIncrementAction</span> <span class="token operator">=</span> <span class="token parameter">data</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'increment'</span><span class="token punctuation">,</span> data<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// 异步action</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">createIncrementAsyncAction</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">time<span class="token punctuation">,</span> data</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// 函数第一个参数就是dispatch</span>
    <span class="token keyword">return</span> <span class="token parameter">dispatch</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">createIncrementAction</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span> time<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><ol start="4"><li>使用</li></ol> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> store <span class="token keyword">from</span> <span class="token string">'../../redux/store'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> createIncrementAction<span class="token punctuation">,</span> createIncrementAsyncAction <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'../../redux/count_action'</span>

<span class="token comment">// 挂载时监听store数据变化</span>
<span class="token function">componentDidMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    store<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token comment">// 调用setState可更新数据</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 分发reducer 触发reducer</span>
store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">createIncrementAction</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><hr> <h2 id="状态管理react-redux"><a href="#状态管理react-redux" class="header-anchor">#</a> 状态管理react-redux</h2> <h4 id="原理图-2"><a href="#原理图-2" class="header-anchor">#</a> 原理图</h4> <p><img src="https://vkceyugu.cdn.bspapp.com/VKCEYUGU-ce1af42d-76fa-4a5c-9768-cebbc1aa816f/5673aa66-e61a-40f2-83af-093259d269f3.png" alt="react-redux原理图"></p> <h4 id="引入方法"><a href="#引入方法" class="header-anchor">#</a> 引入方法</h4> <ol><li>创建容器组件</li></ol> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 创建/src/container/Count/index.jsx</span>
<span class="token keyword">import</span> CountUI <span class="token keyword">from</span> <span class="token string">'../../component/Count'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> connect <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react-redux'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> 
    createIncrementAction<span class="token punctuation">,</span>
    createDecrementAction<span class="token punctuation">,</span>
    createIncrementAsyncAction
<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'../../redux/count_action'</span><span class="token punctuation">;</span>

<span class="token comment">// 映射state到props</span>
<span class="token keyword">const</span> <span class="token function-variable function">mapStateToProps</span> <span class="token operator">=</span> <span class="token parameter">state</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">count</span><span class="token operator">:</span> state<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// 映射dispatch到props</span>
<span class="token comment">// 写法一 返回函数</span>
<span class="token comment">// 这个函数交由store处理，后续执行时，store会将dispatch作为参数传递过来</span>
<span class="token keyword">const</span> <span class="token function-variable function">mapDispatchToProps</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">dispatch</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token punctuation">{</span>
            <span class="token function-variable function">increment</span><span class="token operator">:</span> <span class="token parameter">data</span> <span class="token operator">=&gt;</span> <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">createIncrementAction</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token function-variable function">decrement</span><span class="token operator">:</span> <span class="token parameter">data</span> <span class="token operator">=&gt;</span> <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">createDecrementAction</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token function-variable function">incrementAsync</span><span class="token operator">:</span> <span class="token parameter">data</span> <span class="token operator">=&gt;</span> <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">createIncrementAsyncAction</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">// 写法二 返回对象</span>
<span class="token comment">// 简写</span>
<span class="token keyword">const</span> mapDispatchToProps <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">increment</span><span class="token operator">:</span> createIncrementAction<span class="token punctuation">,</span>
    <span class="token literal-property property">decrement</span><span class="token operator">:</span> createDecrementAction<span class="token punctuation">,</span>
    <span class="token literal-property property">incrementAsync</span><span class="token operator">:</span> createIncrementAsyncAction<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">connect</span><span class="token punctuation">(</span>mapStateToProps<span class="token punctuation">,</span> mapDispatchToProps<span class="token punctuation">)</span><span class="token punctuation">(</span>CountUI<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br></div></div><ol start="2"><li>页面使用容器组件 并传入store</li></ol> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> Count <span class="token keyword">from</span> <span class="token string">'./container/Count'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> store <span class="token keyword">from</span> <span class="token string">'./redux/store'</span><span class="token punctuation">;</span>

<span class="token operator">...</span>
<span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
        <span class="token operator">&lt;</span>Count store<span class="token operator">=</span><span class="token punctuation">{</span>store<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><ol start="3"><li>UI组件中使用state和改变state</li></ol> <div class="language-js line-numbers-mode"><pre class="language-js"><code>
<span class="token comment">// 调用dispatch改变state</span>
<span class="token function-variable function">increment</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span><span class="token function">increment</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>refs<span class="token punctuation">.</span>se<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// 使用state</span>
<span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token operator">&lt;</span>h3<span class="token operator">&gt;</span>当前求和为<span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>count <span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>h3<span class="token operator">&gt;</span>    
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h4 id="优化"><a href="#优化" class="header-anchor">#</a> 优化</h4> <ol><li>使用react-redux后，可不用写监听store数据变化，以下代码可删除</li></ol> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token function">componentDidMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    store<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token comment">// 调用setState可更新数据</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><ol start="2"><li>react-redux中，不用每个容器组件都给传store，只需给最外层包裹一层Provider</li></ol> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 可将这个store去掉</span>
<span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
        <span class="token operator">&lt;</span>Count store<span class="token operator">=</span><span class="token punctuation">{</span>store<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// 在App中最外层包裹一个Provider</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Provider <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react-redux'</span><span class="token punctuation">;</span>

<span class="token operator">&lt;</span>Provider store<span class="token operator">=</span><span class="token punctuation">{</span>store<span class="token punctuation">}</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>App <span class="token operator">/</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>Provider<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><ol start="3"><li>将容器组件与UI组件定义在一个文件中</li></ol> <h4 id="定义多个redux状态"><a href="#定义多个redux状态" class="header-anchor">#</a> 定义多个redux状态</h4> <ol><li>定义action和reducer</li></ol> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// action</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">createPersonAction</span> <span class="token operator">=</span> <span class="token parameter">data</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'add'</span><span class="token punctuation">,</span> data <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// reducer</span>
<span class="token keyword">const</span> initState <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">18</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">PersonReducer</span> <span class="token punctuation">(</span><span class="token parameter">prev <span class="token operator">=</span> initState<span class="token punctuation">,</span> action</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> type<span class="token punctuation">,</span> data <span class="token punctuation">}</span> <span class="token operator">=</span> action<span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>type <span class="token operator">===</span> <span class="token string">'add'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">[</span>data<span class="token punctuation">,</span> <span class="token operator">...</span>prev<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> initState<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><ol start="2"><li>合并redux状态</li></ol> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// store中</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> createStore<span class="token punctuation">,</span> applyMiddleware<span class="token punctuation">,</span> combineReducers <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'redux'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> countReducer <span class="token keyword">from</span> <span class="token string">&quot;./count_reducer&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> personReducer <span class="token keyword">from</span> <span class="token string">&quot;./person_reducer&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">createStore</span><span class="token punctuation">(</span><span class="token function">combineReducers</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">count</span><span class="token operator">:</span> countReducer<span class="token punctuation">,</span>
  <span class="token literal-property property">persons</span><span class="token operator">:</span> personReducer<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">applyMiddleware</span><span class="token punctuation">(</span>thunk<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><ol start="3"><li>在容器组件中使用</li></ol> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>
    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>persons<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token punctuation">}</span>
    
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2022/12/14 09:39</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/my-articles/pages/studyNote/开课吧web高级.html" class="prev">
        开课吧web高级
      </a></span> <!----></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/my-articles/assets/js/app.bb82ac71.js" defer></script><script src="/my-articles/assets/js/2.9cb2f34b.js" defer></script><script src="/my-articles/assets/js/34.23ec2839.js" defer></script>
  </body>
</html>
